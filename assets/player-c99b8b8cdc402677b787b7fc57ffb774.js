function onYouTubePlayerAPIReady(){mejs.YouTubeApi.iFrameReady()}function onYouTubePlayerReady(e){mejs.YouTubeApi.flashReady(e)}!function(e,t){"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.Handlebars=t()}(this,function(){var e=function(){"use strict";function e(e){return l[e]}function t(e){for(var t=1;t<arguments.length;t++)for(var i in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],i)&&(e[i]=arguments[t][i]);return e}function i(e,t){for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1}function n(t){return t&&t.toHTML?t.toHTML():null==t?"":t?(t=""+t,u.test(t)?t.replace(c,e):t):t+""}function o(e){return e||0===e?h(e)&&0===e.length?!0:!1:!0}function r(e,t){return e.path=t,e}function s(e,t){return(e?e+".":"")+t}var a={},l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=/[&<>"'`]/g,u=/[&<>"'`]/;a.extend=t;var d=Object.prototype.toString;a.toString=d;var p=function(e){return"function"==typeof e};p(/x/)&&(p=function(e){return"function"==typeof e&&"[object Function]"===d.call(e)});var p;a.isFunction=p;var h=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===d.call(e):!1};return a.isArray=h,a.indexOf=i,a.escapeExpression=n,a.isEmpty=o,a.blockParams=r,a.appendContextPath=s,a}(),t=function(){"use strict";function e(e,t){var n,o,r=t&&t.loc;r&&(n=r.start.line,o=r.start.column,e+=" - "+n+":"+o);for(var s=Error.prototype.constructor.call(this,e),a=0;a<i.length;a++)this[i[a]]=s[i[a]];r&&(this.lineNumber=n,this.column=o)}var t,i=["description","fileName","lineNumber","message","name","number","stack"];return e.prototype=new Error,t=e}(),i=function(e,t){"use strict";function i(e,t){this.helpers=e||{},this.partials=t||{},n(this)}function n(e){e.registerHelper("helperMissing",function(){if(1===arguments.length)return void 0;throw new s("Missing helper: '"+arguments[arguments.length-1].name+"'")}),e.registerHelper("blockHelperMissing",function(t,i){var n=i.inverse,o=i.fn;if(t===!0)return o(this);if(t===!1||null==t)return n(this);if(u(t))return t.length>0?(i.ids&&(i.ids=[i.name]),e.helpers.each(t,i)):n(this);if(i.data&&i.ids){var s=g(i.data);s.contextPath=r.appendContextPath(i.data.contextPath,i.name),i={data:s}}return o(t,i)}),e.registerHelper("each",function(e,t){function i(t,i,s){n&&(n.key=t,n.index=i,n.first=0===i,n.last=!!s,o&&(n.contextPath=o+t)),p+=a(e[t],{data:n,blockParams:r.blockParams([e[t],t],[o+t,null])})}if(!t)throw new s("Must pass iterator to #each");var n,o,a=t.fn,l=t.inverse,c=0,p="";if(t.data&&t.ids&&(o=r.appendContextPath(t.data.contextPath,t.ids[0])+"."),d(e)&&(e=e.call(this)),t.data&&(n=g(t.data)),e&&"object"==typeof e)if(u(e))for(var h=e.length;h>c;c++)i(c,c,c===e.length-1);else{var m;for(var f in e)e.hasOwnProperty(f)&&(m&&i(m,c-1),m=f,c++);m&&i(m,c-1,!0)}return 0===c&&(p=l(this)),p}),e.registerHelper("if",function(e,t){return d(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||r.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,i){return e.helpers["if"].call(this,t,{fn:i.inverse,inverse:i.fn,hash:i.hash})}),e.registerHelper("with",function(e,t){d(e)&&(e=e.call(this));var i=t.fn;if(r.isEmpty(e))return t.inverse(this);if(t.data&&t.ids){var n=g(t.data);n.contextPath=r.appendContextPath(t.data.contextPath,t.ids[0]),t={data:n}}return i(e,t)}),e.registerHelper("log",function(t,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;e.log(n,t)}),e.registerHelper("lookup",function(e,t){return e&&e[t]})}var o={},r=e,s=t,a="3.0.0";o.VERSION=a;var l=6;o.COMPILER_REVISION=l;var c={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1"};o.REVISION_CHANGES=c;var u=r.isArray,d=r.isFunction,p=r.toString,h="[object Object]";o.HandlebarsEnvironment=i,i.prototype={constructor:i,logger:m,log:f,registerHelper:function(e,t){if(p.call(e)===h){if(t)throw new s("Arg not supported with multiple helpers");r.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(p.call(e)===h)r.extend(this.partials,e);else{if("undefined"==typeof t)throw new s("Attempting to register a partial as undefined");this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]}};var m={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:1,log:function(e,t){if("undefined"!=typeof console&&m.level<=e){var i=m.methodMap[e];(console[i]||console.log).call(console,t)}}};o.logger=m;var f=m.log;o.log=f;var g=function(e){var t=r.extend({},e);return t._parent=e,t};return o.createFrame=g,o}(e,t),n=function(){"use strict";function e(e){this.string=e}var t;return e.prototype.toString=e.prototype.toHTML=function(){return""+this.string},t=e}(),o=function(e,t,i){"use strict";function n(e){var t=e&&e[0]||1,i=h;if(t!==i){if(i>t){var n=m[i],o=m[t];throw new p("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new p("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function o(e,t){if(!t)throw new p("No environment passed to template");if(!e||!e.main)throw new p("Unknown template object: "+typeof e);t.VM.checkRevision(e.compiler);var i=function(i,n,o){o.hash&&(n=d.extend({},n,o.hash)),i=t.VM.resolvePartial.call(this,i,n,o);var r=t.VM.invokePartial.call(this,i,n,o);if(null==r&&t.compile&&(o.partials[o.name]=t.compile(i,e.compilerOptions,t),r=o.partials[o.name](n,o)),null!=r){if(o.indent){for(var s=r.split("\n"),a=0,l=s.length;l>a&&(s[a]||a+1!==l);a++)s[a]=o.indent+s[a];r=s.join("\n")}return r}throw new p("The partial "+o.name+" could not be compiled when running in runtime-only mode")},n={strict:function(e,t){if(!(t in e))throw new p('"'+t+'" not defined in '+e);return e[t]},lookup:function(e,t){for(var i=e.length,n=0;i>n;n++)if(e[n]&&null!=e[n][t])return e[n][t]},lambda:function(e,t){return"function"==typeof e?e.call(t):e},escapeExpression:d.escapeExpression,invokePartial:i,fn:function(t){return e[t]},programs:[],program:function(e,t,i,n,o){var s=this.programs[e],a=this.fn(e);return t||o||n||i?s=r(this,e,a,t,i,n,o):s||(s=this.programs[e]=r(this,e,a)),s},data:function(e,t){for(;e&&t--;)e=e._parent;return e},merge:function(e,t){var i=e||t;return e&&t&&e!==t&&(i=d.extend({},t,e)),i},noop:t.VM.noop,compilerInfo:e.compiler},o=function(t,i){i=i||{};var r=i.data;o._setup(i),!i.partial&&e.useData&&(r=c(t,r));var s,a=e.useBlockParams?[]:void 0;return e.useDepths&&(s=i.depths?[t].concat(i.depths):[t]),e.main.call(n,t,n.helpers,n.partials,r,a,s)};return o.isTop=!0,o._setup=function(i){i.partial?(n.helpers=i.helpers,n.partials=i.partials):(n.helpers=n.merge(i.helpers,t.helpers),e.usePartial&&(n.partials=n.merge(i.partials,t.partials)))},o._child=function(t,i,o,s){if(e.useBlockParams&&!o)throw new p("must pass block params");if(e.useDepths&&!s)throw new p("must pass parent depths");return r(n,t,e[t],i,0,o,s)},o}function r(e,t,i,n,o,r,s){var a=function(t,o){return o=o||{},i.call(e,t,e.helpers,e.partials,o.data||n,r&&[o.blockParams].concat(r),s&&[t].concat(s))};return a.program=t,a.depth=s?s.length:0,a.blockParams=o||0,a}function s(e,t,i){return e?e.call||i.name||(i.name=e,e=i.partials[e]):e=i.partials[i.name],e}function a(e,t,i){if(i.partial=!0,void 0===e)throw new p("The partial "+i.name+" could not be found");return e instanceof Function?e(t,i):void 0}function l(){return""}function c(e,t){return t&&"root"in t||(t=t?f(t):{},t.root=e),t}var u={},d=e,p=t,h=i.COMPILER_REVISION,m=i.REVISION_CHANGES,f=i.createFrame;return u.checkRevision=n,u.template=o,u.program=r,u.resolvePartial=s,u.invokePartial=a,u.noop=l,u}(e,t,i),r=function(e,t,i,n,o){"use strict";var r,s=e,a=t,l=i,c=n,u=o,d=function(){var e=new s.HandlebarsEnvironment;return c.extend(e,s),e.SafeString=a,e.Exception=l,e.Utils=c,e.escapeExpression=c.escapeExpression,e.VM=u,e.template=function(t){return u.template(t,e)},e},p=d();p.create=d;var h="undefined"!=typeof global?global:window,m=h.Handlebars;return p.noConflict=function(){h.Handlebars===p&&(h.Handlebars=m)},p["default"]=p,r=p}(i,n,t,e,o);return r}),function(e,t){if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(i,n,o){e.Backbone=t(e,o,i,n)});else if("undefined"!=typeof exports){var i=require("underscore");t(e,exports,i)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,i,n){{var o=e.Backbone,r=[],s=(r.push,r.slice);r.splice}t.VERSION="1.1.2",t.$=n,t.noConflict=function(){return e.Backbone=o,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(e,t,i){if(!c(this,"on",e,[t,i])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,n){if(!c(this,"once",e,[t,n])||!t)return this;var o=this,r=i.once(function(){o.off(e,r),t.apply(this,arguments)});return r._callback=t,this.on(e,r,n)},off:function(e,t,n){var o,r,s,a,l,u,d,p;if(!this._events||!c(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(a=e?[e]:i.keys(this._events),l=0,u=a.length;u>l;l++)if(e=a[l],s=this._events[e]){if(this._events[e]=o=[],t||n)for(d=0,p=s.length;p>d;d++)r=s[d],(t&&t!==r.callback&&t!==r.callback._callback||n&&n!==r.context)&&o.push(r);o.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!c(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&u(i,t),n&&u(n,arguments),this},stopListening:function(e,t,n){var o=this._listeningTo;if(!o)return this;var r=!t&&!n;n||"object"!=typeof t||(n=this),e&&((o={})[e._listenId]=e);for(var s in o)e=o[s],e.off(t,n,this),(r||i.isEmpty(e._events))&&delete this._listeningTo[s];return this}},l=/\s+/,c=function(e,t,i,n){if(!i)return!0;if("object"==typeof i){for(var o in i)e[t].apply(e,[o,i[o]].concat(n));return!1}if(l.test(i)){for(var r=i.split(l),s=0,a=r.length;a>s;s++)e[t].apply(e,[r[s]].concat(n));return!1}return!0},u=function(e,t){var i,n=-1,o=e.length,r=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++n<o;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r);return;case 2:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r,s);return;case 3:for(;++n<o;)(i=e[n]).callback.call(i.ctx,r,s,a);return;default:for(;++n<o;)(i=e[n]).callback.apply(i.ctx,t);return}},d={listenTo:"on",listenToOnce:"once"};i.each(d,function(e,t){a[t]=function(t,n,o){var r=this._listeningTo||(this._listeningTo={}),s=t._listenId||(t._listenId=i.uniqueId("l"));return r[s]=t,o||"object"!=typeof n||(o=this),t[e](n,o,this),this}}),a.bind=a.on,a.unbind=a.off,i.extend(t,a);var p=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)};i.extend(p.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var o,r,s,a,l,c,u,d;if(null==e)return this;if("object"==typeof e?(r=e,n=t):(r={})[e]=t,n||(n={}),!this._validate(r,n))return!1;s=n.unset,l=n.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=i.clone(this.attributes),this.changed={}),d=this.attributes,u=this._previousAttributes,this.idAttribute in r&&(this.id=r[this.idAttribute]);for(o in r)t=r[o],i.isEqual(d[o],t)||a.push(o),i.isEqual(u[o],t)?delete this.changed[o]:this.changed[o]=t,s?delete d[o]:d[o]=t;if(!l){a.length&&(this._pending=n);for(var p=0,h=a.length;h>p;p++)this.trigger("change:"+a[p],this,d[a[p]],n)}if(c)return this;if(!l)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t,n=!1,o=this._changing?this._previousAttributes:this.attributes;for(var r in e)i.isEqual(o[r],t=e[r])||((n||(n={}))[r]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){return t.set(t.parse(i,e),e)?(n&&n(t,i,e),void t.trigger("sync",t,i,e)):!1},I(this,e),this.sync("read",this,e)},save:function(e,t,n){var o,r,s,a=this.attributes;if(null==e||"object"==typeof e?(o=e,n=t):(o={})[e]=t,n=i.extend({validate:!0},n),o&&!n.wait){if(!this.set(o,n))return!1}else if(!this._validate(o,n))return!1;o&&n.wait&&(this.attributes=i.extend({},a,o)),void 0===n.parse&&(n.parse=!0);var l=this,c=n.success;return n.success=function(e){l.attributes=a;var t=l.parse(e,n);return n.wait&&(t=i.extend(o||{},t)),i.isObject(t)&&!l.set(t,n)?!1:(c&&c(l,e,n),void l.trigger("sync",l,e,n))},I(this,n),r=this.isNew()?"create":n.patch?"patch":"update","patch"===r&&(n.attrs=o),s=this.sync(r,this,n),o&&n.wait&&(this.attributes=a),s},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,o=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&o(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)},this.isNew())return e.success(),!1;I(this,e);var r=this.sync("delete",this,e);return e.wait||o(),r},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||A();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1):!0}});var h=["keys","values","pairs","invert","pick","omit"];i.each(h,function(e){p.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var m=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))},f={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};i.extend(m.prototype,a,{model:p,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,g))},remove:function(e,t){var n=!i.isArray(e);e=n?[e]:i.clone(e),t||(t={});var o,r,s,a;for(o=0,r=e.length;r>o;o++)a=e[o]=this.get(e[o]),a&&(delete this._byId[a.id],delete this._byId[a.cid],s=this.indexOf(a),this.models.splice(s,1),this.length--,t.silent||(t.index=s,a.trigger("remove",a,this,t)),this._removeReference(a,t));return n?e[0]:e},set:function(e,t){t=i.defaults({},t,f),t.parse&&(e=this.parse(e,t));var n=!i.isArray(e);e=n?e?[e]:[]:i.clone(e);var o,r,s,a,l,c,u,d=t.at,h=this.model,m=this.comparator&&null==d&&t.sort!==!1,g=i.isString(this.comparator)?this.comparator:null,y=[],v=[],b={},w=t.add,k=t.merge,_=t.remove,T=!m&&w&&_?[]:!1;for(o=0,r=e.length;r>o;o++){if(l=e[o]||{},s=l instanceof p?a=l:l[h.prototype.idAttribute||"id"],c=this.get(s))_&&(b[c.cid]=!0),k&&(l=l===a?a.attributes:l,t.parse&&(l=c.parse(l,t)),c.set(l,t),m&&!u&&c.hasChanged(g)&&(u=!0)),e[o]=c;else if(w){if(a=e[o]=this._prepareModel(l,t),!a)continue;y.push(a),this._addReference(a,t)}a=c||a,!T||!a.isNew()&&b[a.id]||T.push(a),b[a.id]=!0}if(_){for(o=0,r=this.length;r>o;++o)b[(a=this.models[o]).cid]||v.push(a);v.length&&this.remove(v,t)}if(y.length||T&&T.length)if(m&&(u=!0),this.length+=y.length,null!=d)for(o=0,r=y.length;r>o;o++)this.models.splice(d+o,0,y[o]);else{T&&(this.models.length=0);var j=T||y;for(o=0,r=j.length;r>o;o++)this.models.push(j[o])}if(u&&this.sort({silent:!0}),!t.silent){for(o=0,r=y.length;r>o;o++)(a=y[o]).trigger("add",a,this,t);(u||T&&T.length)&&this.trigger("sort",this,t)}return n?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,o=this.models.length;o>n;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,i.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return s.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var o=e.reset?"reset":"set";n[o](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},I(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,o=t.success;return t.success=function(e,i){t.wait&&n.add(e,t),o&&o(e,i,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof p)return e;t=t?i.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_addReference:function(e){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var y=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];i.each(y,function(e){m.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var v=["groupBy","countBy","sortBy","indexBy"];i.each(v,function(e){m.prototype[e]=function(t,n){var o=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,o,n)}});var b=t.View=function(e){this.cid=i.uniqueId("view"),e||(e={}),i.extend(this,i.pick(e,k)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName","events"];i.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),n){var o=t.match(w),r=o[1],s=o[2];n=i.bind(n,this),r+=".delegateEvents"+this.cid,""===s?this.$el.on(r,n):this.$el.on(r,s,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,o){var r=T[e];i.defaults(o||(o={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:r,dataType:"json"};if(o.url||(s.url=i.result(n,"url")||A()),null!=o.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(o.attrs||n.toJSON(o))),o.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),o.emulateHTTP&&("PUT"===r||"DELETE"===r||"PATCH"===r)){s.type="POST",o.emulateJSON&&(s.data._method=r);var a=o.beforeSend;o.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",r),a?a.apply(this,arguments):void 0}}"GET"===s.type||o.emulateJSON||(s.processData=!1),"PATCH"===s.type&&_&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=o.xhr=t.ajax(i.extend(s,o));return n.trigger("request",n,l,o),l};var _=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),T={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var j=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},E=/\((.*?)\)/g,x=/(\(\?)?:\w+/g,S=/\*\w+/g,C=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(j.prototype,a,{initialize:function(){},route:function(e,n,o){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(o=n,n=""),o||(o=this[n]);var r=this;return t.history.route(e,function(i){var s=r._extractParameters(e,i);r.execute(o,s),r.trigger.apply(r,["route:"+n].concat(s)),r.trigger("route",n,s),t.history.trigger("route",r,n,s)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(C,"\\$&").replace(E,"(?:$1)?").replace(x,function(e,t){return t?e:"([^/?]+)"}).replace(S,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);return i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var M=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},N=/^[#\/]|\s+$/g,P=/^\/+|\/+$/g,B=/msie [\w.]+/,$=/\/$/,F=/#.*$/;M.started=!1,i.extend(M.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace($,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(N,"")},start:function(e){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),o=document.documentMode,r=B.exec(navigator.userAgent.toLowerCase())&&(!o||7>=o);if(this.root=("/"+this.root+"/").replace(P,"/"),r&&this._wantsHashChange){var s=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=s.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!r?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(N,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),M.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),i.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!M.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));if(e=e.replace(F,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new M;var V=function(e,t){var n,o=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return o.apply(this,arguments)},i.extend(n,o,t);var r=function(){this.constructor=n};return r.prototype=o.prototype,n.prototype=new r,e&&i.extend(n.prototype,e),n.__super__=o.prototype,n};p.extend=m.extend=j.extend=b.extend=M.extend=V;var A=function(){throw new Error('A "url" property or function must be specified')},I=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}};return t}),function(){var e,t=[].slice;e=function(){var e,i,n,o,r,s;return o=1<=arguments.length?t.call(arguments,0):[],r=/(^|[\s\n]|<br\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi,o.length>0&&(n=o[0],i=function(){var t;t=[];for(e in n)s=n[e],"callback"!==e&&t.push(" "+e+"='"+s+"'");return t}().join("")),this.replace(r,function(e,t,o){var r,s;return null!=n.callback?r=n.callback(o):(s=document.createElement("a"),s.href=o,r="<a href='"+o+"'"+i+">"+s.hostname.replace("www.","")+"</a>"),""+t+r})},String.prototype.autoLink=e}.call(this);var mejs=mejs||{};mejs.version="2.16.4",mejs.meIndex=0,mejs.plugins={silverlight:[{version:[3,0],types:["video/mp4","video/m4v","video/mov","video/wmv","audio/wma","audio/m4a","audio/mp3","audio/wav","audio/mpeg"]}],flash:[{version:[9,0,124],types:["video/mp4","video/m4v","video/mov","video/flv","video/rtmp","video/x-flv","audio/flv","audio/x-flv","audio/mp3","audio/m4a","audio/mpeg","video/youtube","video/x-youtube","application/x-mpegURL"]}],youtube:[{version:null,types:["video/youtube","video/x-youtube","audio/youtube","audio/x-youtube"]}],vimeo:[{version:null,types:["video/vimeo","video/x-vimeo"]}]},mejs.Utility={encodeUrl:function(e){return encodeURIComponent(e)},escapeHTML:function(e){return e.toString().split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;")},absolutizeUrl:function(e){var t=document.createElement("div");return t.innerHTML='<a href="'+this.escapeHTML(e)+'">x</a>',t.firstChild.href},getScriptPath:function(e){for(var t,i,n,o,r,s,a=0,l="",c="",u=document.getElementsByTagName("script"),d=u.length,p=e.length;d>a;a++){for(o=u[a].src,i=o.lastIndexOf("/"),i>-1?(s=o.substring(i+1),r=o.substring(0,i+1)):(s=o,r=""),t=0;p>t;t++)if(c=e[t],n=s.indexOf(c),n>-1){l=r;break}if(""!==l)break}return l},secondsToTimeCode:function(e,t,i,n){"undefined"==typeof i?i=!1:"undefined"==typeof n&&(n=25);var o=Math.floor(e/3600)%24,r=Math.floor(e/60)%60,s=Math.floor(e%60),a=Math.floor((e%1*n).toFixed(3)),l=(t||o>0?(10>o?"0"+o:o)+":":"")+(10>r?"0"+r:r)+":"+(10>s?"0"+s:s)+(i?":"+(10>a?"0"+a:a):"");return l},timeCodeToSeconds:function(e,t,i,n){"undefined"==typeof i?i=!1:"undefined"==typeof n&&(n=25);var o=e.split(":"),r=parseInt(o[0],10),s=parseInt(o[1],10),a=parseInt(o[2],10),l=0,c=0;return i&&(l=parseInt(o[3])/n),c=3600*r+60*s+a+l},convertSMPTEtoSeconds:function(e){if("string"!=typeof e)return!1;e=e.replace(",",".");var t=0,i=-1!=e.indexOf(".")?e.split(".")[1].length:0,n=1;e=e.split(":").reverse();for(var o=0;o<e.length;o++)n=1,o>0&&(n=Math.pow(60,o)),t+=Number(e[o])*n;return Number(t.toFixed(i))},removeSwf:function(e){var t=document.getElementById(e);t&&/object|embed/i.test(t.nodeName)&&(mejs.MediaFeatures.isIE?(t.style.display="none",function(){4==t.readyState?mejs.Utility.removeObjectInIE(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))},removeObjectInIE:function(e){var t=document.getElementById(e);if(t){for(var i in t)"function"==typeof t[i]&&(t[i]=null);t.parentNode.removeChild(t)}}},mejs.PluginDetector={hasPluginVersion:function(e,t){var i=this.plugins[e];return t[1]=t[1]||0,t[2]=t[2]||0,i[0]>t[0]||i[0]==t[0]&&i[1]>t[1]||i[0]==t[0]&&i[1]==t[1]&&i[2]>=t[2]?!0:!1},nav:window.navigator,ua:window.navigator.userAgent.toLowerCase(),plugins:[],addPlugin:function(e,t,i,n,o){this.plugins[e]=this.detectPlugin(t,i,n,o)},detectPlugin:function(e,t,i,n){var o,r,s,a=[0,0,0];if("undefined"!=typeof this.nav.plugins&&"object"==typeof this.nav.plugins[e]){if(o=this.nav.plugins[e].description,o&&("undefined"==typeof this.nav.mimeTypes||!this.nav.mimeTypes[t]||this.nav.mimeTypes[t].enabledPlugin))for(a=o.replace(e,"").replace(/^\s+/,"").replace(/\sr/gi,".").split("."),r=0;r<a.length;r++)a[r]=parseInt(a[r].match(/\d+/),10)}else if("undefined"!=typeof window.ActiveXObject)try{s=new ActiveXObject(i),s&&(a=n(s))}catch(l){}return a}},mejs.PluginDetector.addPlugin("flash","Shockwave Flash","application/x-shockwave-flash","ShockwaveFlash.ShockwaveFlash",function(e){var t=[],i=e.GetVariable("$version");return i&&(i=i.split(" ")[1].split(","),t=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]),t}),mejs.PluginDetector.addPlugin("silverlight","Silverlight Plug-In","application/x-silverlight-2","AgControl.AgControl",function(e){var t=[0,0,0,0],i=function(e,t,i,n){for(;e.isVersionSupported(t[0]+"."+t[1]+"."+t[2]+"."+t[3]);)t[i]+=n;t[i]-=n};return i(e,t,0,1),i(e,t,1,1),i(e,t,2,1e4),i(e,t,2,1e3),i(e,t,2,100),i(e,t,2,10),i(e,t,2,1),i(e,t,3,1),t}),mejs.MediaFeatures={init:function(){var e,t,i=this,n=document,o=mejs.PluginDetector.nav,r=mejs.PluginDetector.ua.toLowerCase(),s=["source","track","audio","video"];i.isiPad=null!==r.match(/ipad/i),i.isiPhone=null!==r.match(/iphone/i),i.isiOS=i.isiPhone||i.isiPad,i.isAndroid=null!==r.match(/android/i),i.isBustedAndroid=null!==r.match(/android 2\.[12]/),i.isBustedNativeHTTPS="https:"===location.protocol&&(null!==r.match(/android [12]\./)||null!==r.match(/macintosh.* version.* safari/)),i.isIE=-1!=o.appName.toLowerCase().indexOf("microsoft")||null!==o.appName.toLowerCase().match(/trident/gi),i.isChrome=null!==r.match(/chrome/gi),i.isChromium=null!==r.match(/chromium/gi),i.isFirefox=null!==r.match(/firefox/gi),i.isWebkit=null!==r.match(/webkit/gi),i.isGecko=null!==r.match(/gecko/gi)&&!i.isWebkit&&!i.isIE,i.isOpera=null!==r.match(/opera/gi),i.hasTouch="ontouchstart"in window,i.svg=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect;
for(e=0;e<s.length;e++)t=document.createElement(s[e]);i.supportsMediaTag="undefined"!=typeof t.canPlayType||i.isBustedAndroid;try{t.canPlayType("video/mp4")}catch(a){i.supportsMediaTag=!1}i.hasSemiNativeFullScreen="undefined"!=typeof t.webkitEnterFullscreen,i.hasNativeFullscreen="undefined"!=typeof t.requestFullscreen,i.hasWebkitNativeFullScreen="undefined"!=typeof t.webkitRequestFullScreen,i.hasMozNativeFullScreen="undefined"!=typeof t.mozRequestFullScreen,i.hasMsNativeFullScreen="undefined"!=typeof t.msRequestFullscreen,i.hasTrueNativeFullScreen=i.hasWebkitNativeFullScreen||i.hasMozNativeFullScreen||i.hasMsNativeFullScreen,i.nativeFullScreenEnabled=i.hasTrueNativeFullScreen,i.hasMozNativeFullScreen?i.nativeFullScreenEnabled=document.mozFullScreenEnabled:i.hasMsNativeFullScreen&&(i.nativeFullScreenEnabled=document.msFullscreenEnabled),i.isChrome&&(i.hasSemiNativeFullScreen=!1),i.hasTrueNativeFullScreen&&(i.fullScreenEventName="",i.hasWebkitNativeFullScreen?i.fullScreenEventName="webkitfullscreenchange":i.hasMozNativeFullScreen?i.fullScreenEventName="mozfullscreenchange":i.hasMsNativeFullScreen&&(i.fullScreenEventName="MSFullscreenChange"),i.isFullScreen=function(){return i.hasMozNativeFullScreen?n.mozFullScreen:i.hasWebkitNativeFullScreen?n.webkitIsFullScreen:i.hasMsNativeFullScreen?null!==n.msFullscreenElement:void 0},i.requestFullScreen=function(e){i.hasWebkitNativeFullScreen?e.webkitRequestFullScreen():i.hasMozNativeFullScreen?e.mozRequestFullScreen():i.hasMsNativeFullScreen&&e.msRequestFullscreen()},i.cancelFullScreen=function(){i.hasWebkitNativeFullScreen?document.webkitCancelFullScreen():i.hasMozNativeFullScreen?document.mozCancelFullScreen():i.hasMsNativeFullScreen&&document.msExitFullscreen()}),i.hasSemiNativeFullScreen&&r.match(/mac os x 10_5/i)&&(i.hasNativeFullScreen=!1,i.hasSemiNativeFullScreen=!1)}},mejs.MediaFeatures.init(),mejs.HtmlMediaElement={pluginType:"native",isFullScreen:!1,setCurrentTime:function(e){this.currentTime=e},setMuted:function(e){this.muted=e},setVolume:function(e){this.volume=e},stop:function(){this.pause()},setSrc:function(e){for(var t=this.getElementsByTagName("source");t.length>0;)this.removeChild(t[0]);if("string"==typeof e)this.src=e;else{var i,n;for(i=0;i<e.length;i++)if(n=e[i],this.canPlayType(n.type)){this.src=n.src;break}}},setVideoSize:function(e,t){this.width=e,this.height=t}},mejs.PluginMediaElement=function(e,t,i){this.id=e,this.pluginType=t,this.src=i,this.events={},this.attributes={}},mejs.PluginMediaElement.prototype={pluginElement:null,pluginType:"",isFullScreen:!1,playbackRate:-1,defaultPlaybackRate:-1,seekable:[],played:[],paused:!0,ended:!1,seeking:!1,duration:0,error:null,tagName:"",muted:!1,volume:1,currentTime:0,play:function(){null!=this.pluginApi&&("youtube"==this.pluginType||"vimeo"==this.pluginType?this.pluginApi.playVideo():this.pluginApi.playMedia(),this.paused=!1)},load:function(){null!=this.pluginApi&&("youtube"==this.pluginType||"vimeo"==this.pluginType||this.pluginApi.loadMedia(),this.paused=!1)},pause:function(){null!=this.pluginApi&&("youtube"==this.pluginType||"vimeo"==this.pluginType?this.pluginApi.pauseVideo():this.pluginApi.pauseMedia(),this.paused=!0)},stop:function(){null!=this.pluginApi&&("youtube"==this.pluginType||"vimeo"==this.pluginType?this.pluginApi.stopVideo():this.pluginApi.stopMedia(),this.paused=!0)},canPlayType:function(e){var t,i,n,o=mejs.plugins[this.pluginType];for(t=0;t<o.length;t++)if(n=o[t],mejs.PluginDetector.hasPluginVersion(this.pluginType,n.version))for(i=0;i<n.types.length;i++)if(e==n.types[i])return"probably";return""},positionFullscreenButton:function(e,t,i){null!=this.pluginApi&&this.pluginApi.positionFullscreenButton&&this.pluginApi.positionFullscreenButton(Math.floor(e),Math.floor(t),i)},hideFullscreenButton:function(){null!=this.pluginApi&&this.pluginApi.hideFullscreenButton&&this.pluginApi.hideFullscreenButton()},setSrc:function(e){if("string"==typeof e)this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(e)),this.src=mejs.Utility.absolutizeUrl(e);else{var t,i;for(t=0;t<e.length;t++)if(i=e[t],this.canPlayType(i.type)){this.pluginApi.setSrc(mejs.Utility.absolutizeUrl(i.src)),this.src=mejs.Utility.absolutizeUrl(e);break}}},setCurrentTime:function(e){null!=this.pluginApi&&("youtube"==this.pluginType||"vimeo"==this.pluginType?this.pluginApi.seekTo(e):this.pluginApi.setCurrentTime(e),this.currentTime=e)},setVolume:function(e){null!=this.pluginApi&&(this.pluginApi.setVolume("youtube"==this.pluginType?100*e:e),this.volume=e)},setMuted:function(e){null!=this.pluginApi&&("youtube"==this.pluginType?(e?this.pluginApi.mute():this.pluginApi.unMute(),this.muted=e,this.dispatchEvent("volumechange")):this.pluginApi.setMuted(e),this.muted=e)},setVideoSize:function(e,t){this.pluginElement&&this.pluginElement.style&&(this.pluginElement.style.width=e+"px",this.pluginElement.style.height=t+"px"),null!=this.pluginApi&&this.pluginApi.setVideoSize&&this.pluginApi.setVideoSize(e,t)},setFullscreen:function(e){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.pluginApi.setFullscreen(e)},enterFullScreen:function(){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.setFullscreen(!0)},exitFullScreen:function(){null!=this.pluginApi&&this.pluginApi.setFullscreen&&this.setFullscreen(!1)},addEventListener:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},removeEventListener:function(e,t){if(!e)return this.events={},!0;var i=this.events[e];if(!i)return!0;if(!t)return this.events[e]=[],!0;for(var n=0;n<i.length;n++)if(i[n]===t)return this.events[e].splice(n,1),!0;return!1},dispatchEvent:function(e){var t,i,n=this.events[e];if(n)for(i=Array.prototype.slice.call(arguments,1),t=0;t<n.length;t++)n[t].apply(this,i)},hasAttribute:function(e){return e in this.attributes},removeAttribute:function(e){delete this.attributes[e]},getAttribute:function(e){return this.hasAttribute(e)?this.attributes[e]:""},setAttribute:function(e,t){this.attributes[e]=t},remove:function(){mejs.Utility.removeSwf(this.pluginElement.id),mejs.MediaPluginBridge.unregisterPluginElement(this.pluginElement.id)}},mejs.MediaPluginBridge={pluginMediaElements:{},htmlMediaElements:{},registerPluginElement:function(e,t,i){this.pluginMediaElements[e]=t,this.htmlMediaElements[e]=i},unregisterPluginElement:function(e){delete this.pluginMediaElements[e],delete this.htmlMediaElements[e]},initPlugin:function(e){var t=this.pluginMediaElements[e],i=this.htmlMediaElements[e];if(t){switch(t.pluginType){case"flash":t.pluginElement=t.pluginApi=document.getElementById(e);break;case"silverlight":t.pluginElement=document.getElementById(t.id),t.pluginApi=t.pluginElement.Content.MediaElementJS}null!=t.pluginApi&&t.success&&t.success(t,i)}},fireEvent:function(e,t,i){var n,o,r,s=this.pluginMediaElements[e];if(s){n={type:t,target:s};for(o in i)s[o]=i[o],n[o]=i[o];r=i.bufferedTime||0,n.target.buffered=n.buffered={start:function(){return 0},end:function(){return r},length:1},s.dispatchEvent(n.type,n)}}},mejs.MediaElementDefaults={mode:"auto",plugins:["flash","silverlight","youtube","vimeo"],enablePluginDebug:!1,httpsBasicAuthSite:!1,type:"",pluginPath:mejs.Utility.getScriptPath(["mediaelement.js","mediaelement.min.js","mediaelement-and-player.js","mediaelement-and-player.min.js"]),flashName:"flashmediaelement.swf",flashStreamer:"",enablePluginSmoothing:!1,enablePseudoStreaming:!1,pseudoStreamingStartQueryParam:"start",silverlightName:"silverlightmediaelement.xap",defaultVideoWidth:480,defaultVideoHeight:270,pluginWidth:-1,pluginHeight:-1,pluginVars:[],timerRate:250,startVolume:.8,success:function(){},error:function(){}},mejs.MediaElement=function(e,t){return mejs.HtmlMediaElementShim.create(e,t)},mejs.HtmlMediaElementShim={create:function(e,t){var i,n,o=mejs.MediaElementDefaults,r="string"==typeof e?document.getElementById(e):e,s=r.tagName.toLowerCase(),a="audio"===s||"video"===s,l=r.getAttribute(a?"src":"href"),c=r.getAttribute("poster"),u=r.getAttribute("autoplay"),d=r.getAttribute("preload"),p=r.getAttribute("controls");for(n in t)o[n]=t[n];return l="undefined"==typeof l||null===l||""==l?null:l,c="undefined"==typeof c||null===c?"":c,d="undefined"==typeof d||null===d||"false"===d?"none":d,u=!("undefined"==typeof u||null===u||"false"===u),p=!("undefined"==typeof p||null===p||"false"===p),i=this.determinePlayback(r,o,mejs.MediaFeatures.supportsMediaTag,a,l),i.url=null!==i.url?mejs.Utility.absolutizeUrl(i.url):"","native"==i.method?(mejs.MediaFeatures.isBustedAndroid&&(r.src=i.url,r.addEventListener("click",function(){r.play()},!1)),this.updateNative(i,o,u,d)):""!==i.method?this.createPlugin(i,o,c,u,d,p):(this.createErrorMessage(i,o,c),this)},determinePlayback:function(e,t,i,n,o){var r,s,a,l,c,u,d,p,h,m,f,g=[],y={method:"",url:"",htmlMediaElement:e,isVideo:"audio"!=e.tagName.toLowerCase()};if("undefined"!=typeof t.type&&""!==t.type)if("string"==typeof t.type)g.push({type:t.type,url:o});else for(r=0;r<t.type.length;r++)g.push({type:t.type[r],url:o});else if(null!==o)u=this.formatType(o,e.getAttribute("type")),g.push({type:u,url:o});else for(r=0;r<e.childNodes.length;r++)c=e.childNodes[r],1==c.nodeType&&"source"==c.tagName.toLowerCase()&&(o=c.getAttribute("src"),u=this.formatType(o,c.getAttribute("type")),f=c.getAttribute("media"),(!f||!window.matchMedia||window.matchMedia&&window.matchMedia(f).matches)&&g.push({type:u,url:o}));if(!n&&g.length>0&&null!==g[0].url&&this.getTypeFromFile(g[0].url).indexOf("audio")>-1&&(y.isVideo=!1),mejs.MediaFeatures.isBustedAndroid&&(e.canPlayType=function(e){return null!==e.match(/video\/(mp4|m4v)/gi)?"maybe":""}),mejs.MediaFeatures.isChromium&&(e.canPlayType=function(e){return null!==e.match(/video\/(webm|ogv|ogg)/gi)?"maybe":""}),!(!i||"auto"!==t.mode&&"auto_plugin"!==t.mode&&"native"!==t.mode||mejs.MediaFeatures.isBustedNativeHTTPS&&t.httpsBasicAuthSite===!0)){for(n||(m=document.createElement(y.isVideo?"video":"audio"),e.parentNode.insertBefore(m,e),e.style.display="none",y.htmlMediaElement=e=m),r=0;r<g.length;r++)if("video/m3u8"==g[r].type||""!==e.canPlayType(g[r].type).replace(/no/,"")||""!==e.canPlayType(g[r].type.replace(/mp3/,"mpeg")).replace(/no/,"")||""!==e.canPlayType(g[r].type.replace(/m4a/,"mp4")).replace(/no/,"")){y.method="native",y.url=g[r].url;break}if("native"===y.method&&(null!==y.url&&(e.src=y.url),"auto_plugin"!==t.mode))return y}if("auto"===t.mode||"auto_plugin"===t.mode||"shim"===t.mode)for(r=0;r<g.length;r++)for(u=g[r].type,s=0;s<t.plugins.length;s++)for(d=t.plugins[s],p=mejs.plugins[d],a=0;a<p.length;a++)if(h=p[a],null==h.version||mejs.PluginDetector.hasPluginVersion(d,h.version))for(l=0;l<h.types.length;l++)if(u==h.types[l])return y.method=d,y.url=g[r].url,y;return"auto_plugin"===t.mode&&"native"===y.method?y:(""===y.method&&g.length>0&&(y.url=g[0].url),y)},formatType:function(e,t){return e&&!t?this.getTypeFromFile(e):t&&~t.indexOf(";")?t.substr(0,t.indexOf(";")):t},getTypeFromFile:function(e){e=e.split("?")[0];var t=e.substring(e.lastIndexOf(".")+1).toLowerCase();return(/(mp4|m4v|ogg|ogv|m3u8|webm|webmv|flv|wmv|mpeg|mov)/gi.test(t)?"video":"audio")+"/"+this.getTypeFromExtension(t)},getTypeFromExtension:function(e){switch(e){case"mp4":case"m4v":case"m4a":return"mp4";case"webm":case"webma":case"webmv":return"webm";case"ogg":case"oga":case"ogv":return"ogg";default:return e}},createErrorMessage:function(e,t,i){var n=e.htmlMediaElement,o=document.createElement("div");o.className="me-cannotplay";try{o.style.width=n.width+"px",o.style.height=n.height+"px"}catch(r){}o.innerHTML=t.customError?t.customError:""!==i?'<a href="'+e.url+'"><img src="'+i+'" width="100%" height="100%" /></a>':'<a href="'+e.url+'"><span>'+mejs.i18n.t("Download File")+"</span></a>",n.parentNode.insertBefore(o,n),n.style.display="none",t.error(n)},createPlugin:function(e,t,i,n,o,r){var s,a,l,c=e.htmlMediaElement,u=1,d=1,p="me_"+e.method+"_"+mejs.meIndex++,h=new mejs.PluginMediaElement(p,e.method,e.url),m=document.createElement("div");h.tagName=c.tagName;for(var f=0;f<c.attributes.length;f++){var g=c.attributes[f];1==g.specified&&h.setAttribute(g.name,g.value)}for(a=c.parentNode;null!==a&&"body"!==a.tagName.toLowerCase()&&null!=a.parentNode;){if("p"===a.parentNode.tagName.toLowerCase()){a.parentNode.parentNode.insertBefore(a,a.parentNode);break}a=a.parentNode}switch(e.isVideo?(u=t.pluginWidth>0?t.pluginWidth:t.videoWidth>0?t.videoWidth:null!==c.getAttribute("width")?c.getAttribute("width"):t.defaultVideoWidth,d=t.pluginHeight>0?t.pluginHeight:t.videoHeight>0?t.videoHeight:null!==c.getAttribute("height")?c.getAttribute("height"):t.defaultVideoHeight,u=mejs.Utility.encodeUrl(u),d=mejs.Utility.encodeUrl(d)):t.enablePluginDebug&&(u=320,d=240),h.success=t.success,mejs.MediaPluginBridge.registerPluginElement(p,h,c),m.className="me-plugin",m.id=p+"_container",e.isVideo?c.parentNode.insertBefore(m,c):document.body.insertBefore(m,document.body.childNodes[0]),l=["id="+p,"jsinitfunction=mejs.MediaPluginBridge.initPlugin","jscallbackfunction=mejs.MediaPluginBridge.fireEvent","isvideo="+(e.isVideo?"true":"false"),"autoplay="+(n?"true":"false"),"preload="+o,"width="+u,"startvolume="+t.startVolume,"timerrate="+t.timerRate,"flashstreamer="+t.flashStreamer,"height="+d,"pseudostreamstart="+t.pseudoStreamingStartQueryParam],null!==e.url&&l.push("flash"==e.method?"file="+mejs.Utility.encodeUrl(e.url):"file="+e.url),t.enablePluginDebug&&l.push("debug=true"),t.enablePluginSmoothing&&l.push("smoothing=true"),t.enablePseudoStreaming&&l.push("pseudostreaming=true"),r&&l.push("controls=true"),t.pluginVars&&(l=l.concat(t.pluginVars)),e.method){case"silverlight":m.innerHTML='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2" id="'+p+'" name="'+p+'" width="'+u+'" height="'+d+'" class="mejs-shim"><param name="initParams" value="'+l.join(",")+'" /><param name="windowless" value="true" /><param name="background" value="black" /><param name="minRuntimeVersion" value="3.0.0.0" /><param name="autoUpgrade" value="true" /><param name="source" value="'+t.pluginPath+t.silverlightName+'" /></object>';break;case"flash":mejs.MediaFeatures.isIE?(s=document.createElement("div"),m.appendChild(s),s.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+p+'" width="'+u+'" height="'+d+'" class="mejs-shim"><param name="movie" value="'+t.pluginPath+t.flashName+"?x="+new Date+'" /><param name="flashvars" value="'+l.join("&amp;")+'" /><param name="quality" value="high" /><param name="bgcolor" value="#000000" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /><param name="scale" value="default" /></object>'):m.innerHTML='<embed id="'+p+'" name="'+p+'" play="true" loop="false" quality="high" bgcolor="#000000" wmode="transparent" allowScriptAccess="always" allowFullScreen="true" type="application/x-shockwave-flash" pluginspage="//www.macromedia.com/go/getflashplayer" src="'+t.pluginPath+t.flashName+'" flashvars="'+l.join("&")+'" width="'+u+'" height="'+d+'" scale="default"class="mejs-shim"></embed>';break;case"youtube":var y;-1!=e.url.lastIndexOf("youtu.be")?(y=e.url.substr(e.url.lastIndexOf("/")+1),-1!=y.indexOf("?")&&(y=y.substr(0,y.indexOf("?")))):y=e.url.substr(e.url.lastIndexOf("=")+1),youtubeSettings={container:m,containerId:m.id,pluginMediaElement:h,pluginId:p,videoId:y,height:d,width:u},mejs.PluginDetector.hasPluginVersion("flash",[10,0,0])?mejs.YouTubeApi.createFlash(youtubeSettings):mejs.YouTubeApi.enqueueIframe(youtubeSettings);break;case"vimeo":var v=p+"_player";if(h.vimeoid=e.url.substr(e.url.lastIndexOf("/")+1),m.innerHTML='<iframe src="//player.vimeo.com/video/'+h.vimeoid+"?api=1&portrait=0&byline=0&title=0&player_id="+v+'" width="'+u+'" height="'+d+'" frameborder="0" class="mejs-shim" id="'+v+'" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>',"function"==typeof $f){var b=$f(m.childNodes[0]);b.addEvent("ready",function(){function e(e,t,i,n){var o={type:i,target:t};"timeupdate"==i&&(t.currentTime=o.currentTime=n.seconds,t.duration=o.duration=n.duration),t.dispatchEvent(o.type,o)}b.playVideo=function(){b.api("play")},b.stopVideo=function(){b.api("unload")},b.pauseVideo=function(){b.api("pause")},b.seekTo=function(e){b.api("seekTo",e)},b.setVolume=function(e){b.api("setVolume",e)},b.setMuted=function(e){e?(b.lastVolume=b.api("getVolume"),b.api("setVolume",0)):(b.api("setVolume",b.lastVolume),delete b.lastVolume)},b.addEvent("play",function(){e(b,h,"play"),e(b,h,"playing")}),b.addEvent("pause",function(){e(b,h,"pause")}),b.addEvent("finish",function(){e(b,h,"ended")}),b.addEvent("playProgress",function(t){e(b,h,"timeupdate",t)}),h.pluginElement=m,h.pluginApi=b,mejs.MediaPluginBridge.initPlugin(p)})}else console.warn("You need to include froogaloop for vimeo to work")}return c.style.display="none",c.removeAttribute("autoplay"),h},updateNative:function(e,t){var i,n=e.htmlMediaElement;for(i in mejs.HtmlMediaElement)n[i]=mejs.HtmlMediaElement[i];return t.success(n,n),n}},mejs.YouTubeApi={isIframeStarted:!1,isIframeLoaded:!1,loadIframeApi:function(){if(!this.isIframeStarted){var e=document.createElement("script");e.src="//www.youtube.com/player_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),this.isIframeStarted=!0}},iframeQueue:[],enqueueIframe:function(e){this.isLoaded?this.createIframe(e):(this.loadIframeApi(),this.iframeQueue.push(e))},createIframe:function(e){var t=e.pluginMediaElement,i=new YT.Player(e.containerId,{height:e.height,width:e.width,videoId:e.videoId,playerVars:{controls:0},events:{onReady:function(){e.pluginMediaElement.pluginApi=i,mejs.MediaPluginBridge.initPlugin(e.pluginId),setInterval(function(){mejs.YouTubeApi.createEvent(i,t,"timeupdate")},250)},onStateChange:function(e){mejs.YouTubeApi.handleStateChange(e.data,i,t)}}})},createEvent:function(e,t,i){var n={type:i,target:t};if(e&&e.getDuration){t.currentTime=n.currentTime=e.getCurrentTime(),t.duration=n.duration=e.getDuration(),n.paused=t.paused,n.ended=t.ended,n.muted=e.isMuted(),n.volume=e.getVolume()/100,n.bytesTotal=e.getVideoBytesTotal(),n.bufferedBytes=e.getVideoBytesLoaded();var o=n.bufferedBytes/n.bytesTotal*n.duration;n.target.buffered=n.buffered={start:function(){return 0},end:function(){return o},length:1}}t.dispatchEvent(n.type,n)},iFrameReady:function(){for(this.isLoaded=!0,this.isIframeLoaded=!0;this.iframeQueue.length>0;){var e=this.iframeQueue.pop();this.createIframe(e)}},flashPlayers:{},createFlash:function(e){this.flashPlayers[e.pluginId]=e;var t,i="//www.youtube.com/apiplayer?enablejsapi=1&amp;playerapiid="+e.pluginId+"&amp;version=3&amp;autoplay=0&amp;controls=0&amp;modestbranding=1&loop=0";mejs.MediaFeatures.isIE?(t=document.createElement("div"),e.container.appendChild(t),t.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="//download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+e.pluginId+'" width="'+e.width+'" height="'+e.height+'" class="mejs-shim"><param name="movie" value="'+i+'" /><param name="wmode" value="transparent" /><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="true" /></object>'):e.container.innerHTML='<object type="application/x-shockwave-flash" id="'+e.pluginId+'" data="'+i+'" width="'+e.width+'" height="'+e.height+'" style="visibility: visible; " class="mejs-shim"><param name="allowScriptAccess" value="always"><param name="wmode" value="transparent"></object>'},flashReady:function(e){var t=this.flashPlayers[e],i=document.getElementById(e),n=t.pluginMediaElement;n.pluginApi=n.pluginElement=i,mejs.MediaPluginBridge.initPlugin(e),i.cueVideoById(t.videoId);var o=t.containerId+"_callback";window[o]=function(e){mejs.YouTubeApi.handleStateChange(e,i,n)},i.addEventListener("onStateChange",o),setInterval(function(){mejs.YouTubeApi.createEvent(i,n,"timeupdate")},250),mejs.YouTubeApi.createEvent(i,n,"canplay")},handleStateChange:function(e,t,i){switch(e){case-1:i.paused=!0,i.ended=!0,mejs.YouTubeApi.createEvent(t,i,"loadedmetadata");break;case 0:i.paused=!1,i.ended=!0,mejs.YouTubeApi.createEvent(t,i,"ended");break;case 1:i.paused=!1,i.ended=!1,mejs.YouTubeApi.createEvent(t,i,"play"),mejs.YouTubeApi.createEvent(t,i,"playing");break;case 2:i.paused=!0,i.ended=!1,mejs.YouTubeApi.createEvent(t,i,"pause");break;case 3:mejs.YouTubeApi.createEvent(t,i,"progress");break;case 5:}}},window.mejs=mejs,window.MediaElement=mejs.MediaElement,function(e,t){"use strict";var i={locale:{language:t.i18n&&t.i18n.locale.language||"",strings:t.i18n&&t.i18n.locale.strings||{}},ietf_lang_regex:/^(x\-)?[a-z]{2,}(\-\w{2,})?(\-\w{2,})?$/,methods:{}};i.getLanguage=function(){var e=i.locale.language||window.navigator.userLanguage||window.navigator.language;return i.ietf_lang_regex.exec(e)?e:null},"undefined"!=typeof mejsL10n&&(i.locale.language=mejsL10n.language),i.methods.checkPlain=function(e){var t,i,n={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};e=String(e);for(t in n)n.hasOwnProperty(t)&&(i=new RegExp(t,"g"),e=e.replace(i,n[t]));return e},i.methods.t=function(e,t){return i.locale.strings&&i.locale.strings[t.context]&&i.locale.strings[t.context][e]&&(e=i.locale.strings[t.context][e]),i.methods.checkPlain(e)},i.t=function(e,t){if("string"==typeof e&&e.length>0){var n=i.getLanguage();return t=t||{context:n},i.methods.t(e,t)}throw{name:"InvalidArgumentException",message:"First argument is either not a string or empty."}},t.i18n=i}(document,mejs),function(e){"use strict";"undefined"!=typeof mejsL10n&&(e[mejsL10n.language]=mejsL10n.strings)}(mejs.i18n.locale.strings),"undefined"!=typeof jQuery?mejs.$=jQuery:"undefined"!=typeof ender&&(mejs.$=ender),function(e){mejs.MepDefaults={poster:"",showPosterWhenEnded:!1,defaultVideoWidth:480,defaultVideoHeight:270,videoWidth:-1,videoHeight:-1,defaultAudioWidth:400,defaultAudioHeight:30,defaultSeekBackwardInterval:function(e){return.05*e.duration},defaultSeekForwardInterval:function(e){return.05*e.duration},setDimensions:!0,audioWidth:-1,audioHeight:-1,startVolume:.8,loop:!1,autoRewind:!0,enableAutosize:!0,alwaysShowHours:!1,showTimecodeFrameCount:!1,framesPerSecond:25,autosizeProgress:!0,alwaysShowControls:!1,hideVideoControlsOnLoad:!1,clickToPlayPause:!0,iPadUseNativeControls:!1,iPhoneUseNativeControls:!1,AndroidUseNativeControls:!1,features:["playpause","current","progress","duration","tracks","volume","fullscreen"],isVideo:!0,enableKeyboard:!0,pauseOtherPlayers:!0,keyActions:[{keys:[32,179],action:function(e,t){t.paused||t.ended?e.play():e.pause()}},{keys:[38],action:function(e,t){e.container.find(".mejs-volume-slider").css("display","block"),e.isVideo&&(e.showControls(),e.startControlsTimer());var i=Math.min(t.volume+.1,1);t.setVolume(i)}},{keys:[40],action:function(e,t){e.container.find(".mejs-volume-slider").css("display","block"),e.isVideo&&(e.showControls(),e.startControlsTimer());var i=Math.max(t.volume-.1,0);t.setVolume(i)}},{keys:[37,227],action:function(e,t){if(!isNaN(t.duration)&&t.duration>0){e.isVideo&&(e.showControls(),e.startControlsTimer());var i=Math.max(t.currentTime-e.options.defaultSeekBackwardInterval(t),0);t.setCurrentTime(i)}}},{keys:[39,228],action:function(e,t){if(!isNaN(t.duration)&&t.duration>0){e.isVideo&&(e.showControls(),e.startControlsTimer());var i=Math.min(t.currentTime+e.options.defaultSeekForwardInterval(t),t.duration);t.setCurrentTime(i)}}},{keys:[70],action:function(e){"undefined"!=typeof e.enterFullScreen&&(e.isFullScreen?e.exitFullScreen():e.enterFullScreen())}},{keys:[77],action:function(e){e.container.find(".mejs-volume-slider").css("display","block"),e.isVideo&&(e.showControls(),e.startControlsTimer()),e.setMuted(e.media.muted?!1:!0)}}]},mejs.mepIndex=0,mejs.players={},mejs.MediaElementPlayer=function(t,i){if(!(this instanceof mejs.MediaElementPlayer))return new mejs.MediaElementPlayer(t,i);var n=this;return n.$media=n.$node=e(t),n.node=n.media=n.$media[0],"undefined"!=typeof n.node.player?n.node.player:(n.node.player=n,"undefined"==typeof i&&(i=n.$node.data("mejsoptions")),n.options=e.extend({},mejs.MepDefaults,i),n.id="mep_"+mejs.mepIndex++,mejs.players[n.id]=n,n.init(),n)},mejs.MediaElementPlayer.prototype={hasFocus:!1,controlsAreVisible:!0,init:function(){var t=this,i=mejs.MediaFeatures,n=e.extend(!0,{},t.options,{success:function(e,i){t.meReady(e,i)},error:function(e){t.handleError(e)}}),o=t.media.tagName.toLowerCase();if(t.isDynamic="audio"!==o&&"video"!==o,t.isVideo=t.isDynamic?t.options.isVideo:"audio"!==o&&t.options.isVideo,i.isiPad&&t.options.iPadUseNativeControls||i.isiPhone&&t.options.iPhoneUseNativeControls)t.$media.attr("controls","controls"),i.isiPad&&null!==t.media.getAttribute("autoplay")&&t.play();else if(i.isAndroid&&t.options.AndroidUseNativeControls);else{t.$media.removeAttr("controls");var r=mejs.i18n.t(t.isVideo?"Video Player":"Audio Player");if(e('<span class="mejs-offscreen">'+r+"</span>").insertBefore(t.$media),t.container=e('<div id="'+t.id+'" class="mejs-container '+(mejs.MediaFeatures.svg?"svg":"no-svg")+'" tabindex="0" role="application" aria-label="'+r+'"><div class="mejs-inner"><div class="mejs-mediaelement"></div><div class="mejs-layers"></div><div class="mejs-controls"></div><div class="mejs-clear"></div></div></div>').addClass(t.$media[0].className).insertBefore(t.$media).focus(function(){if(!t.controlsAreVisible){t.showControls(!0);var e=t.container.find(".mejs-playpause-button > button");e.focus()}}),t.container.addClass((i.isAndroid?"mejs-android ":"")+(i.isiOS?"mejs-ios ":"")+(i.isiPad?"mejs-ipad ":"")+(i.isiPhone?"mejs-iphone ":"")+(t.isVideo?"mejs-video ":"mejs-audio ")),i.isiOS){var s=t.$media.clone();t.container.find(".mejs-mediaelement").append(s),t.$media.remove(),t.$node=t.$media=s,t.node=t.media=s[0]}else t.container.find(".mejs-mediaelement").append(t.$media);t.controls=t.container.find(".mejs-controls"),t.layers=t.container.find(".mejs-layers");var a=t.isVideo?"video":"audio",l=a.substring(0,1).toUpperCase()+a.substring(1);t.width=t.options[a+"Width"]>0||t.options[a+"Width"].toString().indexOf("%")>-1?t.options[a+"Width"]:""!==t.media.style.width&&null!==t.media.style.width?t.media.style.width:null!==t.media.getAttribute("width")?t.$media.attr("width"):t.options["default"+l+"Width"],t.height=t.options[a+"Height"]>0||t.options[a+"Height"].toString().indexOf("%")>-1?t.options[a+"Height"]:""!==t.media.style.height&&null!==t.media.style.height?t.media.style.height:null!==t.$media[0].getAttribute("height")?t.$media.attr("height"):t.options["default"+l+"Height"],t.setPlayerSize(t.width,t.height),n.pluginWidth=t.width,n.pluginHeight=t.height}mejs.MediaElement(t.$media[0],n),"undefined"!=typeof t.container&&t.controlsAreVisible&&t.container.trigger("controlsshown")},showControls:function(e){var t=this;e="undefined"==typeof e||e,t.controlsAreVisible||(e?(t.controls.css("visibility","visible").stop(!0,!0).fadeIn(200,function(){t.controlsAreVisible=!0,t.container.trigger("controlsshown")}),t.container.find(".mejs-control").css("visibility","visible").stop(!0,!0).fadeIn(200,function(){t.controlsAreVisible=!0})):(t.controls.css("visibility","visible").css("display","block"),t.container.find(".mejs-control").css("visibility","visible").css("display","block"),t.controlsAreVisible=!0,t.container.trigger("controlsshown")),t.setControlsSize())},hideControls:function(t){var i=this;t="undefined"==typeof t||t,!i.controlsAreVisible||i.options.alwaysShowControls||i.keyboardAction||(t?(i.controls.stop(!0,!0).fadeOut(200,function(){e(this).css("visibility","hidden").css("display","block"),i.controlsAreVisible=!1,i.container.trigger("controlshidden")}),i.container.find(".mejs-control").stop(!0,!0).fadeOut(200,function(){e(this).css("visibility","hidden").css("display","block")})):(i.controls.css("visibility","hidden").css("display","block"),i.container.find(".mejs-control").css("visibility","hidden").css("display","block"),i.controlsAreVisible=!1,i.container.trigger("controlshidden")))},controlsTimer:null,startControlsTimer:function(e){var t=this;e="undefined"!=typeof e?e:1500,t.killControlsTimer("start"),t.controlsTimer=setTimeout(function(){t.hideControls(),t.killControlsTimer("hide")},e)},killControlsTimer:function(){var e=this;null!==e.controlsTimer&&(clearTimeout(e.controlsTimer),delete e.controlsTimer,e.controlsTimer=null)},controlsEnabled:!0,disableControls:function(){var e=this;e.killControlsTimer(),e.hideControls(!1),this.controlsEnabled=!1},enableControls:function(){var e=this;e.showControls(!1),e.controlsEnabled=!0},meReady:function(t,i){var n,o,r=this,s=mejs.MediaFeatures,a=i.getAttribute("autoplay"),l=!("undefined"==typeof a||null===a||"false"===a);if(!r.created){if(r.created=!0,r.media=t,r.domNode=i,!(s.isAndroid&&r.options.AndroidUseNativeControls||s.isiPad&&r.options.iPadUseNativeControls||s.isiPhone&&r.options.iPhoneUseNativeControls)){r.buildposter(r,r.controls,r.layers,r.media),r.buildkeyboard(r,r.controls,r.layers,r.media),r.buildoverlays(r,r.controls,r.layers,r.media),r.findTracks();for(n in r.options.features)if(o=r.options.features[n],r["build"+o])try{r["build"+o](r,r.controls,r.layers,r.media)}catch(c){}r.container.trigger("controlsready"),r.setPlayerSize(r.width,r.height),r.setControlsSize(),r.isVideo&&(mejs.MediaFeatures.hasTouch?r.$media.bind("touchstart",function(){r.controlsAreVisible?r.hideControls(!1):r.controlsEnabled&&r.showControls(!1)}):(r.clickToPlayPauseCallback=function(){r.options.clickToPlayPause&&(r.media.paused?r.play():r.pause())},r.media.addEventListener("click",r.clickToPlayPauseCallback,!1),r.container.bind("mouseenter mouseover",function(){r.controlsEnabled&&(r.options.alwaysShowControls||(r.killControlsTimer("enter"),r.showControls(),r.startControlsTimer(2500)))}).bind("mousemove",function(){r.controlsEnabled&&(r.controlsAreVisible||r.showControls(),r.options.alwaysShowControls||r.startControlsTimer(2500))}).bind("mouseleave",function(){r.controlsEnabled&&(r.media.paused||r.options.alwaysShowControls||r.startControlsTimer(1e3))})),r.options.hideVideoControlsOnLoad&&r.hideControls(!1),l&&!r.options.alwaysShowControls&&r.hideControls(),r.options.enableAutosize&&r.media.addEventListener("loadedmetadata",function(e){r.options.videoHeight<=0&&null===r.domNode.getAttribute("height")&&!isNaN(e.target.videoHeight)&&(r.setPlayerSize(e.target.videoWidth,e.target.videoHeight),r.setControlsSize(),r.media.setVideoSize(e.target.videoWidth,e.target.videoHeight))},!1)),t.addEventListener("play",function(){var e;for(e in mejs.players){var t=mejs.players[e];t.id==r.id||!r.options.pauseOtherPlayers||t.paused||t.ended||t.pause(),t.hasFocus=!1}r.hasFocus=!0},!1),r.media.addEventListener("ended",function(){if(r.options.autoRewind)try{r.media.setCurrentTime(0),window.setTimeout(function(){e(r.container).find(".mejs-overlay-loading").parent().hide()},20)}catch(t){}r.media.pause(),r.setProgressRail&&r.setProgressRail(),r.setCurrentRail&&r.setCurrentRail(),r.options.loop?r.play():!r.options.alwaysShowControls&&r.controlsEnabled&&r.showControls()},!1),r.media.addEventListener("loadedmetadata",function(){r.updateDuration&&r.updateDuration(),r.updateCurrent&&r.updateCurrent(),r.isFullScreen||(r.setPlayerSize(r.width,r.height),r.setControlsSize())},!1),r.container.focusout(function(t){if(t.relatedTarget){var i=e(t.relatedTarget);r.keyboardAction&&0===i.parents(".mejs-container").length&&(r.keyboardAction=!1,r.hideControls(!0))}}),setTimeout(function(){r.setPlayerSize(r.width,r.height),r.setControlsSize()},50),r.globalBind("resize",function(){r.isFullScreen||mejs.MediaFeatures.hasTrueNativeFullScreen&&document.webkitIsFullScreen||r.setPlayerSize(r.width,r.height),r.setControlsSize()}),"youtube"==r.media.pluginType&&(s.isiOS||s.isAndroid)&&r.container.find(".mejs-overlay-play").hide()}l&&"native"==t.pluginType&&r.play(),r.options.success&&("string"==typeof r.options.success?window[r.options.success](r.media,r.domNode,r):r.options.success(r.media,r.domNode,r))}},handleError:function(e){var t=this;t.controls.hide(),t.options.error&&t.options.error(e)},setPlayerSize:function(t,i){var n=this;if(!n.options.setDimensions)return!1;if("undefined"!=typeof t&&(n.width=t),"undefined"!=typeof i&&(n.height=i),n.height.toString().indexOf("%")>0||"100%"===n.$node.css("max-width")||n.$node[0].currentStyle&&"100%"===n.$node[0].currentStyle.maxWidth){var o=function(){return n.isVideo?n.media.videoWidth&&n.media.videoWidth>0?n.media.videoWidth:null!==n.media.getAttribute("width")?n.media.getAttribute("width"):n.options.defaultVideoWidth:n.options.defaultAudioWidth}(),r=function(){return n.isVideo?n.media.videoHeight&&n.media.videoHeight>0?n.media.videoHeight:null!==n.media.getAttribute("height")?n.media.getAttribute("height"):n.options.defaultVideoHeight:n.options.defaultAudioHeight}(),s=n.container.parent().closest(":visible").width(),a=n.container.parent().closest(":visible").height(),l=n.isVideo||!n.options.autosizeProgress?parseInt(s*r/o,10):r;
isNaN(l)&&(l=a),"body"===n.container.parent()[0].tagName.toLowerCase()&&(s=e(window).width(),l=e(window).height()),l&&s&&(n.container.width(s).height(l),n.$media.add(n.container.find(".mejs-shim")).width("100%").height("100%"),n.isVideo&&n.media.setVideoSize&&n.media.setVideoSize(s,l),n.layers.children(".mejs-layer").width("100%").height("100%"))}else n.container.width(n.width).height(n.height),n.layers.children(".mejs-layer").width(n.width).height(n.height);var c=n.layers.find(".mejs-overlay-play"),u=c.find(".mejs-overlay-button");c.height(n.container.height()-n.controls.height()),u.css("margin-top","-"+(u.height()/2-n.controls.height()/2).toString()+"px")},setControlsSize:function(){var t=this,i=0,n=0,o=t.controls.find(".mejs-time-rail"),r=t.controls.find(".mejs-time-total"),s=(t.controls.find(".mejs-time-current"),t.controls.find(".mejs-time-loaded"),o.siblings()),a=s.last(),l=null;if(t.container.is(":visible")&&o.length&&o.is(":visible")){t.options&&!t.options.autosizeProgress&&(n=parseInt(o.css("width"),10)),0!==n&&n||(s.each(function(){var t=e(this);"absolute"!=t.css("position")&&t.is(":visible")&&(i+=e(this).outerWidth(!0))}),n=t.controls.width()-i-(o.outerWidth(!0)-o.width()));do o.width(n),r.width(n-(r.outerWidth(!0)-r.width())),"absolute"!=a.css("position")&&(l=a.position(),n--);while(null!==l&&l.top>0&&n>0);t.setProgressRail&&t.setProgressRail(),t.setCurrentRail&&t.setCurrentRail()}},buildposter:function(t,i,n,o){var r=this,s=e('<div class="mejs-poster mejs-layer"></div>').appendTo(n),a=t.$media.attr("poster");""!==t.options.poster&&(a=t.options.poster),a?r.setPoster(a):s.hide(),o.addEventListener("play",function(){s.hide()},!1),t.options.showPosterWhenEnded&&t.options.autoRewind&&o.addEventListener("ended",function(){s.show()},!1)},setPoster:function(t){var i=this,n=i.container.find(".mejs-poster"),o=n.find("img");0===o.length&&(o=e('<img width="100%" height="100%" />').appendTo(n)),o.attr("src",t),n.css({"background-image":"url("+t+")"})},buildoverlays:function(t,i,n,o){var r=this;if(t.isVideo){var s=e('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-loading"><span></span></div></div>').hide().appendTo(n),a=e('<div class="mejs-overlay mejs-layer"><div class="mejs-overlay-error"></div></div>').hide().appendTo(n),l=e('<div class="mejs-overlay mejs-layer mejs-overlay-play"><div class="mejs-overlay-button"></div></div>').appendTo(n).bind("click",function(){r.options.clickToPlayPause&&o.paused&&o.play()});o.addEventListener("play",function(){l.hide(),s.hide(),i.find(".mejs-time-buffering").hide(),a.hide()},!1),o.addEventListener("playing",function(){l.hide(),s.hide(),i.find(".mejs-time-buffering").hide(),a.hide()},!1),o.addEventListener("seeking",function(){s.show(),i.find(".mejs-time-buffering").show()},!1),o.addEventListener("seeked",function(){s.hide(),i.find(".mejs-time-buffering").hide()},!1),o.addEventListener("pause",function(){mejs.MediaFeatures.isiPhone||l.show()},!1),o.addEventListener("waiting",function(){s.show(),i.find(".mejs-time-buffering").show()},!1),o.addEventListener("loadeddata",function(){s.show(),i.find(".mejs-time-buffering").show(),mejs.MediaFeatures.isAndroid&&(o.canplayTimeout=window.setTimeout(function(){if(document.createEvent){var e=document.createEvent("HTMLEvents");return e.initEvent("canplay",!0,!0),o.dispatchEvent(e)}},300))},!1),o.addEventListener("canplay",function(){s.hide(),i.find(".mejs-time-buffering").hide(),clearTimeout(o.canplayTimeout)},!1),o.addEventListener("error",function(){s.hide(),i.find(".mejs-time-buffering").hide(),a.show(),a.find("mejs-overlay-error").html("Error loading this resource")},!1),o.addEventListener("keydown",function(e){r.onkeydown(t,o,e)},!1)}},buildkeyboard:function(t,i,n,o){var r=this;r.container.keydown(function(){r.keyboardAction=!0}),r.globalBind("keydown",function(e){return r.onkeydown(t,o,e)}),r.globalBind("click",function(i){t.hasFocus=0!==e(i.target).closest(".mejs-container").length})},onkeydown:function(e,t,i){if(e.hasFocus&&e.options.enableKeyboard)for(var n=0,o=e.options.keyActions.length;o>n;n++)for(var r=e.options.keyActions[n],s=0,a=r.keys.length;a>s;s++)if(i.keyCode==r.keys[s])return"function"==typeof i.preventDefault&&i.preventDefault(),r.action(e,t,i.keyCode),!1;return!0},findTracks:function(){var t=this,i=t.$media.find("track");t.tracks=[],i.each(function(i,n){n=e(n),t.tracks.push({srclang:n.attr("srclang")?n.attr("srclang").toLowerCase():"",src:n.attr("src"),kind:n.attr("kind"),label:n.attr("label")||"",entries:[],isLoaded:!1})})},changeSkin:function(e){this.container[0].className="mejs-container "+e,this.setPlayerSize(this.width,this.height),this.setControlsSize()},play:function(){this.load(),this.media.play()},pause:function(){try{this.media.pause()}catch(e){}},load:function(){this.isLoaded||this.media.load(),this.isLoaded=!0},setMuted:function(e){this.media.setMuted(e)},setCurrentTime:function(e){this.media.setCurrentTime(e)},getCurrentTime:function(){return this.media.currentTime},setVolume:function(e){this.media.setVolume(e)},getVolume:function(){return this.media.volume},setSrc:function(e){this.media.setSrc(e)},remove:function(){var e,t,i=this;for(e in i.options.features)if(t=i.options.features[e],i["clean"+t])try{i["clean"+t](i)}catch(n){}i.isDynamic?i.$node.insertBefore(i.container):(i.$media.prop("controls",!0),i.$node.clone().insertBefore(i.container).show(),i.$node.remove()),"native"!==i.media.pluginType&&i.media.remove(),delete mejs.players[i.id],"object"==typeof i.container&&i.container.remove(),i.globalUnbind(),delete i.node.player},rebuildtracks:function(){var e=this;e.findTracks(),e.buildtracks(e,e.controls,e.layers,e.media)}},function(){function t(t,n){var o={d:[],w:[]};return e.each((t||"").split(" "),function(e,t){var r=t+"."+n;0===r.indexOf(".")?(o.d.push(r),o.w.push(r)):o[i.test(t)?"w":"d"].push(r)}),o.d=o.d.join(" "),o.w=o.w.join(" "),o}var i=/^((after|before)print|(before)?unload|hashchange|message|o(ff|n)line|page(hide|show)|popstate|resize|storage)\b/;mejs.MediaElementPlayer.prototype.globalBind=function(i,n,o){var r=this;i=t(i,r.id),i.d&&e(document).bind(i.d,n,o),i.w&&e(window).bind(i.w,n,o)},mejs.MediaElementPlayer.prototype.globalUnbind=function(i,n){var o=this;i=t(i,o.id),i.d&&e(document).unbind(i.d,n),i.w&&e(window).unbind(i.w,n)}}(),"undefined"!=typeof e&&(e.fn.mediaelementplayer=function(t){return this.each(t===!1?function(){var t=e(this).data("mediaelementplayer");t&&t.remove(),e(this).removeData("mediaelementplayer")}:function(){e(this).data("mediaelementplayer",new mejs.MediaElementPlayer(this,t))}),this},e(document).ready(function(){e(".mejs-player").mediaelementplayer()})),window.MediaElementPlayer=mejs.MediaElementPlayer}(mejs.$),function(e){e.extend(mejs.MepDefaults,{playText:mejs.i18n.t("Play"),pauseText:mejs.i18n.t("Pause")}),e.extend(MediaElementPlayer.prototype,{buildplaypause:function(t,i,n,o){function r(e){"play"===e?(l.removeClass("mejs-play").addClass("mejs-pause"),c.attr({title:a.pauseText,"aria-label":a.pauseText})):(l.removeClass("mejs-pause").addClass("mejs-play"),c.attr({title:a.playText,"aria-label":a.playText}))}var s=this,a=s.options,l=e('<div class="mejs-button mejs-playpause-button mejs-play" ><button type="button" aria-controls="'+s.id+'" title="'+a.playText+'" aria-label="'+a.playText+'"></button></div>').appendTo(i).click(function(e){return e.preventDefault(),o.paused?o.play():o.pause(),!1}),c=l.find("button");r("pse"),o.addEventListener("play",function(){r("play")},!1),o.addEventListener("playing",function(){r("play")},!1),o.addEventListener("pause",function(){r("pse")},!1),o.addEventListener("paused",function(){r("pse")},!1)}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{stopText:"Stop"}),e.extend(MediaElementPlayer.prototype,{buildstop:function(t,i,n,o){{var r=this;e('<div class="mejs-button mejs-stop-button mejs-stop"><button type="button" aria-controls="'+r.id+'" title="'+r.options.stopText+'" aria-label="'+r.options.stopText+'"></button></div>').appendTo(i).click(function(){o.paused||o.pause(),o.currentTime>0&&(o.setCurrentTime(0),o.pause(),i.find(".mejs-time-current").width("0px"),i.find(".mejs-time-handle").css("left","0px"),i.find(".mejs-time-float-current").html(mejs.Utility.secondsToTimeCode(0)),i.find(".mejs-currenttime").html(mejs.Utility.secondsToTimeCode(0)),n.find(".mejs-poster").show())})}}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{progessHelpText:mejs.i18n.t("Use Left/Right Arrow keys to advance one second, Up/Down arrows to advance ten seconds.")}),e.extend(MediaElementPlayer.prototype,{buildprogress:function(t,i,n,o){e('<div class="mejs-time-rail"><span  class="mejs-time-total mejs-time-slider"><span class="mejs-time-buffering"></span><span class="mejs-time-loaded"></span><span class="mejs-time-current"></span><span class="mejs-time-handle"></span><span class="mejs-time-float"><span class="mejs-time-float-current">00:00</span><span class="mejs-time-float-corner"></span></span></div>').appendTo(i),i.find(".mejs-time-buffering").hide();var r=this,s=i.find(".mejs-time-total"),a=i.find(".mejs-time-loaded"),l=i.find(".mejs-time-current"),c=i.find(".mejs-time-handle"),u=i.find(".mejs-time-float"),d=i.find(".mejs-time-float-current"),p=i.find(".mejs-time-slider"),h=function(e){var t,i=s.offset(),n=s.outerWidth(!0),r=0,a=0,l=0;t=e.originalEvent.changedTouches?e.originalEvent.changedTouches[0].pageX:e.pageX,o.duration&&(t<i.left?t=i.left:t>n+i.left&&(t=n+i.left),l=t-i.left,r=l/n,a=.02>=r?0:r*o.duration,m&&a!==o.currentTime&&o.setCurrentTime(a),mejs.MediaFeatures.hasTouch||(u.css("left",l),d.html(mejs.Utility.secondsToTimeCode(a)),u.show()))},m=!1,f=!1,g=0,y=!1,v=t.options.autoRewind,b=function(){var e=o.currentTime,t=mejs.i18n.t("Time Slider"),i=mejs.Utility.secondsToTimeCode(e),n=o.duration;p.attr({"aria-label":t,"aria-valuemin":0,"aria-valuemax":n,"aria-valuenow":e,"aria-valuetext":i,role:"slider",tabindex:0})},w=function(){var e=new Date;e-g>=1e3&&o.play()};p.bind("focus",function(){t.options.autoRewind=!1}),p.bind("blur",function(){t.options.autoRewind=v}),p.bind("keydown",function(e){new Date-g>=1e3&&(y=o.paused);var t=e.keyCode,i=o.duration,n=o.currentTime;switch(t){case 37:n-=1;break;case 39:n+=1;break;case 38:n+=Math.floor(.1*i);break;case 40:n-=Math.floor(.1*i);break;case 36:n=0;break;case 35:n=i;break;case 10:return void(o.paused?o.play():o.pause());case 13:return void(o.paused?o.play():o.pause());default:return}return n=0>n?0:n>=i?i:Math.floor(n),g=new Date,y||o.pause(),n<o.duration&&!y&&setTimeout(w,1100),o.setCurrentTime(n),e.preventDefault(),e.stopPropagation(),!1}),s.bind("mousedown touchstart",function(e){(1===e.which||0===e.which)&&(m=!0,h(e),r.globalBind("mousemove.dur touchmove.dur",function(e){h(e)}),r.globalBind("mouseup.dur touchend.dur",function(){m=!1,u.hide(),r.globalUnbind(".dur")}))}).bind("mouseenter",function(){f=!0,r.globalBind("mousemove.dur",function(e){h(e)}),mejs.MediaFeatures.hasTouch||u.show()}).bind("mouseleave",function(){f=!1,m||(r.globalUnbind(".dur"),u.hide())}),o.addEventListener("progress",function(e){t.setProgressRail(e),t.setCurrentRail(e)},!1),o.addEventListener("timeupdate",function(e){t.setProgressRail(e),t.setCurrentRail(e),b(e)},!1),r.loaded=a,r.total=s,r.current=l,r.handle=c},setProgressRail:function(e){var t=this,i=void 0!==e?e.target:t.media,n=null;i&&i.buffered&&i.buffered.length>0&&i.buffered.end&&i.duration?n=i.buffered.end(0)/i.duration:i&&void 0!==i.bytesTotal&&i.bytesTotal>0&&void 0!==i.bufferedBytes?n=i.bufferedBytes/i.bytesTotal:e&&e.lengthComputable&&0!==e.total&&(n=e.loaded/e.total),null!==n&&(n=Math.min(1,Math.max(0,n)),t.loaded&&t.total&&t.loaded.width(t.total.width()*n))},setCurrentRail:function(){var e=this;if(void 0!==e.media.currentTime&&e.media.duration&&e.total&&e.handle){var t=Math.round(e.total.width()*e.media.currentTime/e.media.duration),i=t-Math.round(e.handle.outerWidth(!0)/2);e.current.width(t),e.handle.css("left",i)}}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{duration:-1,timeAndDurationSeparator:"<span> | </span>"}),e.extend(MediaElementPlayer.prototype,{buildcurrent:function(t,i,n,o){var r=this;e('<div class="mejs-time" role="timer" aria-live="off"><span class="mejs-currenttime">'+(t.options.alwaysShowHours?"00:":"")+(t.options.showTimecodeFrameCount?"00:00:00":"00:00")+"</span></div>").appendTo(i),r.currenttime=r.controls.find(".mejs-currenttime"),o.addEventListener("timeupdate",function(){t.updateCurrent()},!1)},buildduration:function(t,i,n,o){var r=this;i.children().last().find(".mejs-currenttime").length>0?e(r.options.timeAndDurationSeparator+'<span class="mejs-duration">'+(r.options.duration>0?mejs.Utility.secondsToTimeCode(r.options.duration,r.options.alwaysShowHours||r.media.duration>3600,r.options.showTimecodeFrameCount,r.options.framesPerSecond||25):(t.options.alwaysShowHours?"00:":"")+(t.options.showTimecodeFrameCount?"00:00:00":"00:00"))+"</span>").appendTo(i.find(".mejs-time")):(i.find(".mejs-currenttime").parent().addClass("mejs-currenttime-container"),e('<div class="mejs-time mejs-duration-container"><span class="mejs-duration">'+(r.options.duration>0?mejs.Utility.secondsToTimeCode(r.options.duration,r.options.alwaysShowHours||r.media.duration>3600,r.options.showTimecodeFrameCount,r.options.framesPerSecond||25):(t.options.alwaysShowHours?"00:":"")+(t.options.showTimecodeFrameCount?"00:00:00":"00:00"))+"</span></div>").appendTo(i)),r.durationD=r.controls.find(".mejs-duration"),o.addEventListener("timeupdate",function(){t.updateDuration()},!1)},updateCurrent:function(){var e=this;e.currenttime&&e.currenttime.html(mejs.Utility.secondsToTimeCode(e.media.currentTime,e.options.alwaysShowHours||e.media.duration>3600,e.options.showTimecodeFrameCount,e.options.framesPerSecond||25))},updateDuration:function(){var e=this;e.container.toggleClass("mejs-long-video",e.media.duration>3600),e.durationD&&(e.options.duration>0||e.media.duration)&&e.durationD.html(mejs.Utility.secondsToTimeCode(e.options.duration>0?e.options.duration:e.media.duration,e.options.alwaysShowHours,e.options.showTimecodeFrameCount,e.options.framesPerSecond||25))}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{muteText:mejs.i18n.t("Mute Toggle"),allyVolumeControlText:mejs.i18n.t("Use Up/Down Arrow keys to increase or decrease volume."),hideVolumeOnTouchDevices:!0,audioVolume:"horizontal",videoVolume:"vertical"}),e.extend(MediaElementPlayer.prototype,{buildvolume:function(t,i,n,o){if(!mejs.MediaFeatures.isAndroid&&!mejs.MediaFeatures.isiOS||!this.options.hideVolumeOnTouchDevices){var r=this,s=r.isVideo?r.options.videoVolume:r.options.audioVolume,a="horizontal"==s?e('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="'+r.id+'" title="'+r.options.muteText+'" aria-label="'+r.options.muteText+'"></button></div><a href="javascript:void(0);" class="mejs-horizontal-volume-slider"><span class="mejs-offscreen">'+r.options.allyVolumeControlText+'</span><div class="mejs-horizontal-volume-total"></div><div class="mejs-horizontal-volume-current"></div><div class="mejs-horizontal-volume-handle"></div></a>').appendTo(i):e('<div class="mejs-button mejs-volume-button mejs-mute"><button type="button" aria-controls="'+r.id+'" title="'+r.options.muteText+'" aria-label="'+r.options.muteText+'"></button><a href="javascript:void(0);" class="mejs-volume-slider"><span class="mejs-offscreen">'+r.options.allyVolumeControlText+'</span><div class="mejs-volume-total"></div><div class="mejs-volume-current"></div><div class="mejs-volume-handle"></div></a></div>').appendTo(i),l=r.container.find(".mejs-volume-slider, .mejs-horizontal-volume-slider"),c=r.container.find(".mejs-volume-total, .mejs-horizontal-volume-total"),u=r.container.find(".mejs-volume-current, .mejs-horizontal-volume-current"),d=r.container.find(".mejs-volume-handle, .mejs-horizontal-volume-handle"),p=function(e,t){if(!l.is(":visible")&&"undefined"==typeof t)return l.show(),p(e,!0),void l.hide();e=Math.max(0,e),e=Math.min(e,1),0===e?a.removeClass("mejs-mute").addClass("mejs-unmute"):a.removeClass("mejs-unmute").addClass("mejs-mute");var i=c.position();if("vertical"==s){var n=c.height(),o=n-n*e;d.css("top",Math.round(i.top+o-d.height()/2)),u.height(n-o),u.css("top",i.top+o)}else{var r=c.width(),h=r*e;d.css("left",Math.round(i.left+h-d.width()/2)),u.width(Math.round(h))}},h=function(e){var t=null,i=c.offset();if("vertical"===s){var n=c.height(),r=(parseInt(c.css("top").replace(/px/,""),10),e.pageY-i.top);if(t=(n-r)/n,0===i.top||0===i.left)return}else{var a=c.width(),l=e.pageX-i.left;t=l/a}t=Math.max(0,t),t=Math.min(t,1),p(t),o.setMuted(0===t?!0:!1),o.setVolume(t)},m=!1,f=!1;a.hover(function(){l.show(),f=!0},function(){f=!1,m||"vertical"!=s||l.hide()});var g=function(){var e=Math.floor(100*o.volume);l.attr({"aria-label":mejs.i18n.t("volumeSlider"),"aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":e,"aria-valuetext":e+"%",role:"slider",tabindex:0})};l.bind("mouseover",function(){f=!0}).bind("mousedown",function(e){return h(e),r.globalBind("mousemove.vol",function(e){h(e)}),r.globalBind("mouseup.vol",function(){m=!1,r.globalUnbind(".vol"),f||"vertical"!=s||l.hide()}),m=!0,!1}).bind("keydown",function(e){var t=e.keyCode,i=o.volume;switch(t){case 38:i+=.1;break;case 40:i-=.1;break;default:return!0}return m=!1,p(i),o.setVolume(i),!1}).bind("blur",function(){l.hide()}),a.find("button").click(function(){o.setMuted(!o.muted)}),a.find("button").bind("focus",function(){l.show()}),o.addEventListener("volumechange",function(e){m||(o.muted?(p(0),a.removeClass("mejs-mute").addClass("mejs-unmute")):(p(o.volume),a.removeClass("mejs-unmute").addClass("mejs-mute"))),g(e)},!1),r.container.is(":visible")&&(p(t.options.startVolume),0===t.options.startVolume&&o.setMuted(!0),"native"===o.pluginType&&o.setVolume(t.options.startVolume))}}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{usePluginFullScreen:!0,newWindowCallback:function(){return""},fullscreenText:mejs.i18n.t("Fullscreen")}),e.extend(MediaElementPlayer.prototype,{isFullScreen:!1,isNativeFullScreen:!1,isInIframe:!1,buildfullscreen:function(t,i,n,o){if(t.isVideo){if(t.isInIframe=window.location!=window.parent.location,mejs.MediaFeatures.hasTrueNativeFullScreen){var r=function(){t.isFullScreen&&(mejs.MediaFeatures.isFullScreen()?(t.isNativeFullScreen=!0,t.setControlsSize()):(t.isNativeFullScreen=!1,t.exitFullScreen()))};t.globalBind(mejs.MediaFeatures.fullScreenEventName,r)}var s=this,a=(t.container,e('<div class="mejs-button mejs-fullscreen-button"><button type="button" aria-controls="'+s.id+'" title="'+s.options.fullscreenText+'" aria-label="'+s.options.fullscreenText+'"></button></div>').appendTo(i));if("native"===s.media.pluginType||!s.options.usePluginFullScreen&&!mejs.MediaFeatures.isFirefox)a.click(function(){var e=mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen()||t.isFullScreen;e?t.exitFullScreen():t.enterFullScreen()});else{var l=null,c=function(){var e,t=document.createElement("x"),i=document.documentElement,n=window.getComputedStyle;return"pointerEvents"in t.style?(t.style.pointerEvents="auto",t.style.pointerEvents="x",i.appendChild(t),e=n&&"auto"===n(t,"").pointerEvents,i.removeChild(t),!!e):!1}();if(c&&!mejs.MediaFeatures.isOpera){var u,d,p=!1,h=function(){if(p){for(var e in m)m[e].hide();a.css("pointer-events",""),s.controls.css("pointer-events",""),s.media.removeEventListener("click",s.clickToPlayPauseCallback),p=!1}},m={},f=["top","left","right","bottom"],g=function(){var e=a.offset().left-s.container.offset().left,t=a.offset().top-s.container.offset().top,i=a.outerWidth(!0),n=a.outerHeight(!0),o=s.container.width(),r=s.container.height();for(u in m)m[u].css({position:"absolute",top:0,left:0});m.top.width(o).height(t),m.left.width(e).height(n).css({top:t}),m.right.width(o-e-i).height(n).css({top:t,left:e+i}),m.bottom.width(o).height(r-n-t).css({top:t+n})};for(s.globalBind("resize",function(){g()}),u=0,d=f.length;d>u;u++)m[f[u]]=e('<div class="mejs-fullscreen-hover" />').appendTo(s.container).mouseover(h).hide();a.on("mouseover",function(){if(!s.isFullScreen){var e=a.offset(),i=t.container.offset();o.positionFullscreenButton(e.left-i.left,e.top-i.top,!1),a.css("pointer-events","none"),s.controls.css("pointer-events","none"),s.media.addEventListener("click",s.clickToPlayPauseCallback);for(u in m)m[u].show();g(),p=!0}}),o.addEventListener("fullscreenchange",function(){s.isFullScreen=!s.isFullScreen,s.isFullScreen?s.media.removeEventListener("click",s.clickToPlayPauseCallback):s.media.addEventListener("click",s.clickToPlayPauseCallback),h()}),s.globalBind("mousemove",function(e){if(p){var t=a.offset();(e.pageY<t.top||e.pageY>t.top+a.outerHeight(!0)||e.pageX<t.left||e.pageX>t.left+a.outerWidth(!0))&&(a.css("pointer-events",""),s.controls.css("pointer-events",""),p=!1)}})}else a.on("mouseover",function(){null!==l&&(clearTimeout(l),delete l);var e=a.offset(),i=t.container.offset();o.positionFullscreenButton(e.left-i.left,e.top-i.top,!0)}).on("mouseout",function(){null!==l&&(clearTimeout(l),delete l),l=setTimeout(function(){o.hideFullscreenButton()},1500)})}t.fullscreenBtn=a,s.globalBind("keydown",function(e){(mejs.MediaFeatures.hasTrueNativeFullScreen&&mejs.MediaFeatures.isFullScreen()||s.isFullScreen)&&27==e.keyCode&&t.exitFullScreen()})}},cleanfullscreen:function(e){e.exitFullScreen()},containerSizeTimeout:null,enterFullScreen:function(){var t=this;if("native"===t.media.pluginType||!mejs.MediaFeatures.isFirefox&&!t.options.usePluginFullScreen){if(e(document.documentElement).addClass("mejs-fullscreen"),normalHeight=t.container.height(),normalWidth=t.container.width(),"native"===t.media.pluginType)if(mejs.MediaFeatures.hasTrueNativeFullScreen)mejs.MediaFeatures.requestFullScreen(t.container[0]),t.isInIframe&&setTimeout(function n(){if(t.isNativeFullScreen){var i=window.devicePixelRatio||1,o=.002,r=i*e(window).width(),s=screen.width,a=Math.abs(s-r),l=s*o;a>l?t.exitFullScreen():setTimeout(n,500)}},500);else if(mejs.MediaFeatures.hasSemiNativeFullScreen)return void t.media.webkitEnterFullscreen();if(t.isInIframe){var i=t.options.newWindowCallback(this);if(""!==i){if(!mejs.MediaFeatures.hasTrueNativeFullScreen)return t.pause(),void window.open(i,t.id,"top=0,left=0,width="+screen.availWidth+",height="+screen.availHeight+",resizable=yes,scrollbars=no,status=no,toolbar=no");setTimeout(function(){t.isNativeFullScreen||(t.pause(),window.open(i,t.id,"top=0,left=0,width="+screen.availWidth+",height="+screen.availHeight+",resizable=yes,scrollbars=no,status=no,toolbar=no"))},250)}}t.container.addClass("mejs-container-fullscreen").width("100%").height("100%"),t.containerSizeTimeout=setTimeout(function(){t.container.css({width:"100%",height:"100%"}),t.setControlsSize()},500),"native"===t.media.pluginType?t.$media.width("100%").height("100%"):(t.container.find(".mejs-shim").width("100%").height("100%"),t.media.setVideoSize(e(window).width(),e(window).height())),t.layers.children("div").width("100%").height("100%"),t.fullscreenBtn&&t.fullscreenBtn.removeClass("mejs-fullscreen").addClass("mejs-unfullscreen"),t.setControlsSize(),t.isFullScreen=!0,t.container.find(".mejs-captions-text").css("font-size",screen.width/t.width*1*100+"%"),t.container.find(".mejs-captions-position").css("bottom","45px")}},exitFullScreen:function(){var t=this;return clearTimeout(t.containerSizeTimeout),"native"!==t.media.pluginType&&mejs.MediaFeatures.isFirefox?void t.media.setFullscreen(!1):(mejs.MediaFeatures.hasTrueNativeFullScreen&&(mejs.MediaFeatures.isFullScreen()||t.isFullScreen)&&mejs.MediaFeatures.cancelFullScreen(),e(document.documentElement).removeClass("mejs-fullscreen"),t.container.removeClass("mejs-container-fullscreen").width(normalWidth).height(normalHeight),"native"===t.media.pluginType?t.$media.width(normalWidth).height(normalHeight):(t.container.find(".mejs-shim").width(normalWidth).height(normalHeight),t.media.setVideoSize(normalWidth,normalHeight)),t.layers.children("div").width(normalWidth).height(normalHeight),t.fullscreenBtn.removeClass("mejs-unfullscreen").addClass("mejs-fullscreen"),t.setControlsSize(),t.isFullScreen=!1,t.container.find(".mejs-captions-text").css("font-size",""),void t.container.find(".mejs-captions-position").css("bottom",""))}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{speeds:["2.00","1.50","1.25","1.00","0.75"],defaultSpeed:"1.00",speedChar:"x"}),e.extend(MediaElementPlayer.prototype,{buildspeed:function(t,i,n,o){var r=this;if("native"==r.media.pluginType){var s=null,a=null,l='<div class="mejs-button mejs-speed-button"><button type="button">'+r.options.defaultSpeed+r.options.speedChar+'</button><div class="mejs-speed-selector"><ul>';-1===e.inArray(r.options.defaultSpeed,r.options.speeds)&&r.options.speeds.push(r.options.defaultSpeed),r.options.speeds.sort(function(e,t){return parseFloat(t)-parseFloat(e)});for(var c=0,u=r.options.speeds.length;u>c;c++)l+='<li><input type="radio" name="speed" value="'+r.options.speeds[c]+'" id="'+r.options.speeds[c]+'" '+(r.options.speeds[c]==r.options.defaultSpeed?" checked":"")+' /><label for="'+r.options.speeds[c]+'" '+(r.options.speeds[c]==r.options.defaultSpeed?' class="mejs-speed-selected"':"")+">"+r.options.speeds[c]+r.options.speedChar+"</label></li>";l+="</ul></div></div>",s=e(l).appendTo(i),a=s.find(".mejs-speed-selector"),playbackspeed=r.options.defaultSpeed,a.on("click",'input[type="radio"]',function(){var t=e(this).attr("value");playbackspeed=t,o.playbackRate=parseFloat(t),s.find("button").html(t+r.options.speedChar),s.find(".mejs-speed-selected").removeClass("mejs-speed-selected"),s.find('input[type="radio"]:checked').next().addClass("mejs-speed-selected")}),a.height(s.find(".mejs-speed-selector ul").outerHeight(!0)+s.find(".mejs-speed-translations").outerHeight(!0)).css("top",-1*a.height()+"px")}}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{startLanguage:"",tracksText:mejs.i18n.t("Captions/Subtitles"),hideCaptionsButtonWhenEmpty:!0,toggleCaptionsButtonWhenOnlyOne:!1,slidesSelector:""}),e.extend(MediaElementPlayer.prototype,{hasChapters:!1,cleartracks:function(e){e&&(e.captions&&e.captions.remove(),e.chapters&&e.chapters.remove(),e.captionsText&&e.captionsText.remove(),e.captionsButton&&e.captionsButton.remove())},buildtracks:function(t,i,n,o){if(0!==t.tracks.length){var r,s=this;if(s.domNode.textTracks)for(r=s.domNode.textTracks.length-1;r>=0;r--)s.domNode.textTracks[r].mode="hidden";s.cleartracks(t,i,n,o),t.chapters=e('<div class="mejs-chapters mejs-layer"></div>').prependTo(n).hide(),t.captions=e('<div class="mejs-captions-layer mejs-layer"><div class="mejs-captions-position mejs-captions-position-hover" role="log" aria-live="assertive" aria-atomic="false"><span class="mejs-captions-text"></span></div></div>').prependTo(n).hide(),t.captionsText=t.captions.find(".mejs-captions-text"),t.captionsButton=e('<div class="mejs-button mejs-captions-button"><button type="button" aria-controls="'+s.id+'" title="'+s.options.tracksText+'" aria-label="'+s.options.tracksText+'"></button><div class="mejs-captions-selector"><ul><li><input type="radio" name="'+t.id+'_captions" id="'+t.id+'_captions_none" value="none" checked="checked" /><label for="'+t.id+'_captions_none">'+mejs.i18n.t("None")+"</label></li></ul></div></div>").appendTo(i);var a=0;for(r=0;r<t.tracks.length;r++)"subtitles"==t.tracks[r].kind&&a++;for(s.options.toggleCaptionsButtonWhenOnlyOne&&1==a?t.captionsButton.on("click",function(){lang=null===t.selectedTrack?t.tracks[0].srclang:"none",t.setTrack(lang)}):(t.captionsButton.on("mouseenter focusin",function(){e(this).find(".mejs-captions-selector").css("visibility","visible")}).on("click","input[type=radio]",function(){lang=this.value,t.setTrack(lang)}),t.captionsButton.on("mouseleave focusout",function(){e(this).find(".mejs-captions-selector").css("visibility","hidden")})),t.options.alwaysShowControls?t.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover"):t.container.bind("controlsshown",function(){t.container.find(".mejs-captions-position").addClass("mejs-captions-position-hover")}).bind("controlshidden",function(){o.paused||t.container.find(".mejs-captions-position").removeClass("mejs-captions-position-hover")}),t.trackToLoad=-1,t.selectedTrack=null,t.isLoadingTrack=!1,r=0;r<t.tracks.length;r++)"subtitles"==t.tracks[r].kind&&t.addTrackButton(t.tracks[r].srclang,t.tracks[r].label);t.loadNextTrack(),o.addEventListener("timeupdate",function(){t.displayCaptions()},!1),""!==t.options.slidesSelector&&(t.slidesContainer=e(t.options.slidesSelector),o.addEventListener("timeupdate",function(){t.displaySlides()},!1)),o.addEventListener("loadedmetadata",function(){t.displayChapters()},!1),t.container.hover(function(){t.hasChapters&&(t.chapters.css("visibility","visible"),t.chapters.fadeIn(200).height(t.chapters.find(".mejs-chapter").outerHeight()))},function(){t.hasChapters&&!o.paused&&t.chapters.fadeOut(200,function(){e(this).css("visibility","hidden"),e(this).css("display","block")})}),null!==t.node.getAttribute("autoplay")&&t.chapters.css("visibility","hidden")}},setTrack:function(e){var t,i=this;if("none"==e)i.selectedTrack=null,i.captionsButton.removeClass("mejs-captions-enabled");else for(t=0;t<i.tracks.length;t++)if(i.tracks[t].srclang==e){null===i.selectedTrack&&i.captionsButton.addClass("mejs-captions-enabled"),i.selectedTrack=i.tracks[t],i.captions.attr("lang",i.selectedTrack.srclang),i.displayCaptions();break}},loadNextTrack:function(){var e=this;e.trackToLoad++,e.trackToLoad<e.tracks.length?(e.isLoadingTrack=!0,e.loadTrack(e.trackToLoad)):(e.isLoadingTrack=!1,e.checkForTracks())},loadTrack:function(t){var i=this,n=i.tracks[t],o=function(){n.isLoaded=!0,i.enableTrackButton(n.srclang,n.label),i.loadNextTrack()};e.ajax({url:n.src,dataType:"text",success:function(e){n.entries="string"==typeof e&&/<tt\s+xml/gi.exec(e)?mejs.TrackFormatParser.dfxp.parse(e):mejs.TrackFormatParser.webvtt.parse(e),o(),"chapters"==n.kind&&i.media.addEventListener("play",function(){i.media.duration>0&&i.displayChapters(n)},!1),"slides"==n.kind&&i.setupSlides(n)},error:function(){i.loadNextTrack()}})},enableTrackButton:function(t,i){var n=this;""===i&&(i=mejs.language.codes[t]||t),n.captionsButton.find("input[value="+t+"]").prop("disabled",!1).siblings("label").html(i),n.options.startLanguage==t&&e("#"+n.id+"_captions_"+t).prop("checked",!0).trigger("click"),n.adjustLanguageBox()},addTrackButton:function(t,i){var n=this;""===i&&(i=mejs.language.codes[t]||t),n.captionsButton.find("ul").append(e('<li><input type="radio" name="'+n.id+'_captions" id="'+n.id+"_captions_"+t+'" value="'+t+'" disabled="disabled" /><label for="'+n.id+"_captions_"+t+'">'+i+" (loading)</label></li>")),n.adjustLanguageBox(),n.container.find(".mejs-captions-translations option[value="+t+"]").remove()},adjustLanguageBox:function(){var e=this;e.captionsButton.find(".mejs-captions-selector").height(e.captionsButton.find(".mejs-captions-selector ul").outerHeight(!0)+e.captionsButton.find(".mejs-captions-translations").outerHeight(!0))},checkForTracks:function(){var e=this,t=!1;if(e.options.hideCaptionsButtonWhenEmpty){for(i=0;i<e.tracks.length;i++)if("subtitles"==e.tracks[i].kind){t=!0;break}t||(e.captionsButton.hide(),e.setControlsSize())}},displayCaptions:function(){if("undefined"!=typeof this.tracks){var e,t=this,i=t.selectedTrack;if(null!==i&&i.isLoaded){for(e=0;e<i.entries.times.length;e++)if(t.media.currentTime>=i.entries.times[e].start&&t.media.currentTime<=i.entries.times[e].stop)return t.captionsText.html(i.entries.text[e]).attr("class","mejs-captions-text "+(i.entries.times[e].identifier||"")),void t.captions.show().height(0);t.captions.hide()}else t.captions.hide()}},setupSlides:function(e){var t=this;t.slides=e,t.slides.entries.imgs=[t.slides.entries.text.length],t.showSlide(0)},showSlide:function(t){if("undefined"!=typeof this.tracks&&"undefined"!=typeof this.slidesContainer){var i=this,n=i.slides.entries.text[t],o=i.slides.entries.imgs[t];"undefined"==typeof o||"undefined"==typeof o.fadeIn?i.slides.entries.imgs[t]=o=e('<img src="'+n+'">').on("load",function(){o.appendTo(i.slidesContainer).hide().fadeIn().siblings(":visible").fadeOut()}):o.is(":visible")||o.is(":animated")||o.fadeIn().siblings(":visible").fadeOut()}},displaySlides:function(){if("undefined"!=typeof this.slides){var e,t=this,i=t.slides;for(e=0;e<i.entries.times.length;e++)if(t.media.currentTime>=i.entries.times[e].start&&t.media.currentTime<=i.entries.times[e].stop)return void t.showSlide(e)}},displayChapters:function(){var e,t=this;for(e=0;e<t.tracks.length;e++)if("chapters"==t.tracks[e].kind&&t.tracks[e].isLoaded){t.drawChapters(t.tracks[e]),t.hasChapters=!0;break}},drawChapters:function(t){var i,n,o=this,r=0,s=0;for(o.chapters.empty(),i=0;i<t.entries.times.length;i++)n=t.entries.times[i].stop-t.entries.times[i].start,r=Math.floor(n/o.media.duration*100),(r+s>100||i==t.entries.times.length-1&&100>r+s)&&(r=100-s),o.chapters.append(e('<div class="mejs-chapter" rel="'+t.entries.times[i].start+'" style="left: '+s.toString()+"%;width: "+r.toString()+'%;"><div class="mejs-chapter-block'+(i==t.entries.times.length-1?" mejs-chapter-block-last":"")+'"><span class="ch-title">'+t.entries.text[i]+'</span><span class="ch-time">'+mejs.Utility.secondsToTimeCode(t.entries.times[i].start)+"&ndash;"+mejs.Utility.secondsToTimeCode(t.entries.times[i].stop)+"</span></div></div>")),s+=r;
o.chapters.find("div.mejs-chapter").click(function(){o.media.setCurrentTime(parseFloat(e(this).attr("rel"))),o.media.paused&&o.media.play()}),o.chapters.show()}}),mejs.language={codes:{af:"Afrikaans",sq:"Albanian",ar:"Arabic",be:"Belarusian",bg:"Bulgarian",ca:"Catalan",zh:"Chinese","zh-cn":"Chinese Simplified","zh-tw":"Chinese Traditional",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch",en:"English",et:"Estonian",fl:"Filipino",fi:"Finnish",fr:"French",gl:"Galician",de:"German",el:"Greek",ht:"Haitian Creole",iw:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",ga:"Irish",it:"Italian",ja:"Japanese",ko:"Korean",lv:"Latvian",lt:"Lithuanian",mk:"Macedonian",ms:"Malay",mt:"Maltese",no:"Norwegian",fa:"Persian",pl:"Polish",pt:"Portuguese",ro:"Romanian",ru:"Russian",sr:"Serbian",sk:"Slovak",sl:"Slovenian",es:"Spanish",sw:"Swahili",sv:"Swedish",tl:"Tagalog",th:"Thai",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",cy:"Welsh",yi:"Yiddish"}},mejs.TrackFormatParser={webvtt:{pattern_timecode:/^((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{1,3})?) --\> ((?:[0-9]{1,2}:)?[0-9]{2}:[0-9]{2}([,.][0-9]{3})?)(.*)$/,parse:function(t){for(var i,n,o,r=0,s=mejs.TrackFormatParser.split2(t,/\r?\n/),a={text:[],times:[]};r<s.length;r++){if(i=this.pattern_timecode.exec(s[r]),i&&r<s.length){for(r-1>=0&&""!==s[r-1]&&(o=s[r-1]),r++,n=s[r],r++;""!==s[r]&&r<s.length;)n=n+"\n"+s[r],r++;n=e.trim(n).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>"),a.text.push(n),a.times.push({identifier:o,start:0===mejs.Utility.convertSMPTEtoSeconds(i[1])?.2:mejs.Utility.convertSMPTEtoSeconds(i[1]),stop:mejs.Utility.convertSMPTEtoSeconds(i[3]),settings:i[5]})}o=""}return a}},dfxp:{parse:function(t){t=e(t).filter("tt");var i,n,o=0,r=t.children("div").eq(0),s=r.find("p"),a=t.find("#"+r.attr("style")),l={text:[],times:[]};if(a.length){var c=a.removeAttr("id").get(0).attributes;if(c.length)for(i={},o=0;o<c.length;o++)i[c[o].name.split(":")[1]]=c[o].value}for(o=0;o<s.length;o++){var u,d={start:null,stop:null,style:null};if(s.eq(o).attr("begin")&&(d.start=mejs.Utility.convertSMPTEtoSeconds(s.eq(o).attr("begin"))),!d.start&&s.eq(o-1).attr("end")&&(d.start=mejs.Utility.convertSMPTEtoSeconds(s.eq(o-1).attr("end"))),s.eq(o).attr("end")&&(d.stop=mejs.Utility.convertSMPTEtoSeconds(s.eq(o).attr("end"))),!d.stop&&s.eq(o+1).attr("begin")&&(d.stop=mejs.Utility.convertSMPTEtoSeconds(s.eq(o+1).attr("begin"))),i){u="";for(var p in i)u+=p+":"+i[p]+";"}u&&(d.style=u),0===d.start&&(d.start=.2),l.times.push(d),n=e.trim(s.eq(o).html()).replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,"<a href='$1' target='_blank'>$1</a>"),l.text.push(n),0===l.times.start&&(l.times.start=2)}return l}},split2:function(e,t){return e.split(t)}},3!="x\n\ny".split(/\n/gi).length&&(mejs.TrackFormatParser.split2=function(e,t){var i,n=[],o="";for(i=0;i<e.length;i++)o+=e.substring(i,i+1),t.test(o)&&(n.push(o.replace(t,"")),o="");return n.push(o),n})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{contextMenuItems:[{render:function(e){return"undefined"==typeof e.enterFullScreen?null:mejs.i18n.t(e.isFullScreen?"Turn off Fullscreen":"Go Fullscreen")},click:function(e){e.isFullScreen?e.exitFullScreen():e.enterFullScreen()}},{render:function(e){return mejs.i18n.t(e.media.muted?"Unmute":"Mute")},click:function(e){e.setMuted(e.media.muted?!1:!0)}},{isSeparator:!0},{render:function(){return mejs.i18n.t("Download Video")},click:function(e){window.location.href=e.media.currentSrc}}]}),e.extend(MediaElementPlayer.prototype,{buildcontextmenu:function(t){t.contextMenu=e('<div class="mejs-contextmenu"></div>').appendTo(e("body")).hide(),t.container.bind("contextmenu",function(e){return t.isContextMenuEnabled?(e.preventDefault(),t.renderContextMenu(e.clientX-1,e.clientY-1),!1):void 0}),t.container.bind("click",function(){t.contextMenu.hide()}),t.contextMenu.bind("mouseleave",function(){t.startContextMenuTimer()})},cleancontextmenu:function(e){e.contextMenu.remove()},isContextMenuEnabled:!0,enableContextMenu:function(){this.isContextMenuEnabled=!0},disableContextMenu:function(){this.isContextMenuEnabled=!1},contextMenuTimeout:null,startContextMenuTimer:function(){var e=this;e.killContextMenuTimer(),e.contextMenuTimer=setTimeout(function(){e.hideContextMenu(),e.killContextMenuTimer()},750)},killContextMenuTimer:function(){var e=this.contextMenuTimer;null!=e&&(clearTimeout(e),delete e,e=null)},hideContextMenu:function(){this.contextMenu.hide()},renderContextMenu:function(t,i){for(var n=this,o="",r=n.options.contextMenuItems,s=0,a=r.length;a>s;s++)if(r[s].isSeparator)o+='<div class="mejs-contextmenu-separator"></div>';else{var l=r[s].render(n);null!=l&&(o+='<div class="mejs-contextmenu-item" data-itemindex="'+s+'" id="element-'+1e6*Math.random()+'">'+l+"</div>")}n.contextMenu.empty().append(e(o)).css({top:i,left:t}).show(),n.contextMenu.find(".mejs-contextmenu-item").each(function(){var t=e(this),i=parseInt(t.data("itemindex"),10),o=n.options.contextMenuItems[i];"undefined"!=typeof o.show&&o.show(t,n),t.click(function(){"undefined"!=typeof o.click&&o.click(n),n.contextMenu.hide()})}),setTimeout(function(){n.killControlsTimer("rev3")},100)}})}(mejs.$),function(e){e.extend(mejs.MepDefaults,{postrollCloseText:mejs.i18n.t("Close")}),e.extend(MediaElementPlayer.prototype,{buildpostroll:function(t,i,n){var o=this,r=o.container.find('link[rel="postroll"]').attr("href");"undefined"!=typeof r&&(t.postroll=e('<div class="mejs-postroll-layer mejs-layer"><a class="mejs-postroll-close" onclick="$(this).parent().hide();return false;">'+o.options.postrollCloseText+'</a><div class="mejs-postroll-layer-content"></div></div>').prependTo(n).hide(),o.media.addEventListener("ended",function(){e.ajax({dataType:"html",url:r,success:function(e){n.find(".mejs-postroll-layer-content").html(e)}}),t.postroll.show()},!1))}})}(mejs.$),function(e){function t(t){if("string"==typeof t.data&&(t.data={keys:t.data}),t.data&&t.data.keys&&"string"==typeof t.data.keys){var i=t.handler,n=t.data.keys.toLowerCase().split(" ");t.handler=function(t){if(this===t.target||!(/textarea|select/i.test(t.target.nodeName)||e.hotkeys.options.filterTextInputs&&e.inArray(t.target.type,e.hotkeys.textAcceptingInputTypes)>-1)){var o="keypress"!==t.type&&e.hotkeys.specialKeys[t.which],r=String.fromCharCode(t.which).toLowerCase(),s="",a={};e.each(["alt","ctrl","shift"],function(e,i){t[i+"Key"]&&o!==i&&(s+=i+"+")}),t.metaKey&&!t.ctrlKey&&"meta"!==o&&(s+="meta+"),t.metaKey&&"meta"!==o&&s.indexOf("alt+ctrl+shift+")>-1&&(s=s.replace("alt+ctrl+shift+","hyper+")),o?a[s+o]=!0:(a[s+r]=!0,a[s+e.hotkeys.shiftNums[r]]=!0,"shift+"===s&&(a[e.hotkeys.shiftNums[r]]=!0));for(var l=0,c=n.length;c>l;l++)if(a[n[l]])return i.apply(this,arguments)}}}}e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},textAcceptingInputTypes:["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color","tel"],options:{filterTextInputs:!0}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}})}(jQuery||this.jQuery||window.jQuery),function(){var e,t,i,n,o,r;window.Branchtrack||(window.Branchtrack={}),(e=window.Branchtrack).Models||(e.Models={}),(t=window.Branchtrack).Collections||(t.Collections={}),(i=window.Branchtrack).Views||(i.Views={}),(n=window.Branchtrack.Views).Editor||(n.Editor={}),(o=window.Branchtrack.Views).Player||(o.Player={}),(r=window.Branchtrack).Routers||(r.Routers={}),_.extend(window.bt||(window.bt={}),{dragging:{edge:.05,scroll:10}}),"undefined"!=typeof mejs&&null!==mejs&&(mejs.MediaElementDefaults.pluginPath="/mediaelement/")}.call(this),jQuery.extend(String.prototype,{camelize:function(){return this.replace(/(?:^|[-_])(\w)/g,function(e,t){return t?t.toUpperCase():""})}}),function(){mejs.MediaElementPlayer.prototype.showControls=function(e){return e="undefined"==typeof e||e,this.controlsAreVisible?void 0:(this.controlsAreVisible=!0,e?(this.controls.velocity("stop").velocity({bottom:0},{complete:function(e){return function(){return e.container.trigger("controlsshown")}}(this)}),this.container.find(".mejs-control").css("visibility","visible").stop(!0,!0).fadeIn(200)):(this.controls.css({bottom:0}),this.container.find(".mejs-control").css("visibility","visible").css("display","block"),this.controlsAreVisible=!0,this.container.trigger("controlsshown")),this.setControlsSize())},mejs.MediaElementPlayer.prototype.hideControls=function(e){return e="undefined"==typeof e||e,!this.controlsAreVisible||this.options.alwaysShowControls||this.keyboardAction?void 0:(this.controlsAreVisible=!1,e?(this.controls.velocity("stop").velocity({bottom:-18},{complete:function(e){return function(){return e.container.trigger("controlshidden")}}(this)}),this.container.find(".mejs-control").stop(!0,!0).fadeOut(200,function(e){return function(){return $(e).css("visibility","hidden").css("display","block")}}(this))):(this.controls.css({bottom:-18}),this.container.find(".mejs-control").css("visibility","hidden").css("display","block"),this.container.trigger("controlshidden")))}}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Views.VideoLinkModalView=function(i){function n(){return this.clicked=e(this.clicked,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.tagName="section",n.prototype.className="modal-video",n.prototype.container="body",n.prototype.events={"click a.close-modal-video":"hide"},n.prototype.regex={".*youtube\\.com\\/watch\\?v\\=([^&]+).*":'<iframe width="853" height="480" src="//www.youtube.com/embed/$1" frameborder="0" allowfullscreen></iframe>'},n.prototype.initialize=function(){return $("body").on("click","a",this.clicked),this},n.prototype.render=function(){return this.renderd||(this.renderd=(this.$el.hide().html('<a href="javascript:;" class="fa fa-close close-modal-video"></a><div class="middle"><div class="embed"></div><div><a href="javascript:;" class="button close-modal-video">Close</a></div></div>'),this.$el.appendTo(this.container))),this},n.prototype.clicked=function(e){var t,i,n,o,r;r=[];for(i in this.regex){if(o=new RegExp(i,"i"),n=o.exec(e.currentTarget.href)){t=e.currentTarget.href.replace(o,this.regex[i]),this.render(),this.show(t),null!=e&&e.preventDefault();break}r.push(void 0)}return r},n.prototype.show=function(e){return this.$el.find("div.embed").html(e),this.$el.show()},n.prototype.hide=function(){return this.$el.hide()},n}(Backbone.View)}.call(this),function(){var e;e={collection:Branchtrack.Views,views:{},get:function(e,t,i){var n,o;return null==i&&(i={}),e._views||(e._views={}),"undefined"==typeof e._views[t]&&(n=this.getClassName(e),i.model=e,o=this.findClass(n,t),e._views[t]=new o(i)),e._views[t]},remove:function(e,t){return"undefined"!=typeof e._views[t]?(e._views[t].remove(),delete e._views[t]):void 0},findClass:function(e,t){var i,n,o,r,s,a;for(n=_.map(t.split("/"),function(e){return e.camelize()}),s=n.pop(),a=this.collection,o=0,r=n.length;r>o;o+=1)i=n[o],a=a[i];return a[e+s+"View"]},getClassName:function(e){return e.className}},Branchtrack.Views.get=function(){return e.get.apply(e,arguments)},Branchtrack.Views.remove=function(){return e.remove.apply(e,arguments)}}.call(this),function(){window.Branchtrack.Events=_.extend({},Backbone.Events),window.Branchtrack.Messages=_.extend({},Backbone.Events)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty;Branchtrack.Models.Background=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.className="Background",i.prototype.defaults={player_url:"",small_url:""},i.prototype.imageURL=function(e){return null==e&&(e="small"),this.get(e+"_url")},i.prototype.matchFilter=function(e){if(null==e&&(e={}),e.type)switch(e.type){case"all":return!0;case"private":return!!this.get("private");case"public":return!this.get("private")}return!1},i.prototype.parse=function(e){return null!=e.background?e.background:e},i}(Backbone.Model),Branchtrack.Collections.Backgrounds=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.url="/editor/backgrounds",i.prototype.model=Branchtrack.Models.Background,i.prototype.initialize=function(){},i.prototype.parse=function(e){return e.backgrounds},i}(Backbone.Collection)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty;Branchtrack.Models.Character=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.className="Character",i.prototype.defaults={emotional:!1,emotions:{normal:{player_url:"",small_url:""}},"private":!1},i.prototype.uploader=!1,i.prototype.initialize=function(e,t){return t||(t={}),this.views={}},i.prototype.imageURL=function(e){var t;return null==e&&(e="small"),t=this.get("emotions"),t&&t.normal?t.normal[e+"_url"]:void 0},i.prototype.matchFilter=function(e){if(null==e&&(e={}),e.type)switch(e.type){case"all":return!0;case"private":return!!this.get("private");case"public":return!this.get("private")}return!1},i.prototype.parse=function(e){return null!=e.character?e.character:e},i}(Backbone.Model),Branchtrack.Collections.Characters=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.url="/editor/characters",i.prototype.model=Branchtrack.Models.Character,i.prototype.initialize=function(){},i.prototype.parse=function(e){return e.characters},i}(Backbone.Collection)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty;Branchtrack.Models.Comment=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.className="Comment",i.prototype.initialize=function(e,t){return null==t&&(t={}),this.node=t.node},i.prototype.parse=function(e){return null!=e.comment?e.comment:e},i.prototype.toJSON=function(){return{comment:i.__super__.toJSON.apply(this,arguments)}},i}(Backbone.Model),Branchtrack.Collections.Comments=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.model=Branchtrack.Models.Comment,i.prototype.node=null,i.prototype.initialize=function(e,t){return this.fetched=!1,this.node=t.node},i.prototype.resolvable=function(){return!bt.reviewer},i.prototype.url=function(){return null!=bt.reviewer?bt.reviewer.urlForCommenting()+("/nodes/"+this.node.get("id")+"/comments"):this.node.url()+"/comments"},i.prototype.parse=function(e,t){return null==t&&(t={}),e.comments},i.prototype.success=function(e){var t;return e.meta&&e.meta.node&&this.node.set(e.meta.node),t=this.parse(e),this.set(t,{remove:!1,node:this.node})},i.prototype.resolve=function(){var e,t;return e=this.map(function(e){return e.get("id")}),t=this.last(),$.ajax({url:this.url()+"/resolve",method:"post",dataType:"json",data:{comment_ids:e,time:t?t.get("created_at"):null},success:function(e){return function(t){return e.success(t),e.trigger("resolve:success")}}(this),error:function(e){return function(){return e.trigger("resolve:error")}}(this)})},i.prototype.create=function(e,t){var i;return null==e&&(e={}),null==t&&(t={}),i=this.last(),$.ajax({url:this.url(),method:"post",dataType:"json",data:{comment:e,time:i?i.get("created_at"):null},success:function(e){return function(t){return e.success(t),e.trigger("create:success",t)}}(this),error:function(e){return function(){return e.trigger("create:error")}}(this)})},i}(Backbone.Collection)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Models.Edge=function(i){function n(){return this.checkParentNode=e(this.checkParentNode,this),this.redraw=e(this.redraw,this),this.afterChange=e(this.afterChange,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.className="Edge",n.prototype.sensitiveAttributes=["index","deleted","content","from_node_index","to_node_index","position","voice_id"],n.prototype.defaults={index:0,position:1,content:"",deleted:!1},n.prototype.initialize=function(e,t){return null==t&&(t={}),this.project=bt.project,e.index||console.error("Undefined attribute 'index' for Node"),t.fromNode?this.linkFrom(t.fromNode):e.from_node_index?this.linkFrom(this.project.nodes.findWhere({index:e.from_node_index})):e.from_node_id&&this.linkFrom(this.project.nodes.findWhere({id:e.from_node_id})),t.toNode?this.linkTo(t.toNode):e.to_node_index?this.linkTo(this.project.nodes.findWhere({index:e.to_node_index})):e.to_node_id&&this.linkTo(this.project.nodes.findWhere({id:e.to_node_id})),this.on("change",this.afterChange),this.on("change:content",this.checkParentNode)},n.prototype.url=function(){return this.project.url()+"/edges"+(this.isNew()?"":"/"+this.id)},n.prototype.afterChange=function(e,t){return null==t&&(t={}),t.bayeux?void 0:_.chain(this.changedAttributes()).keys().any(function(e){return function(t){return _(e.sensitiveAttributes).indexOf(t)>-1}}(this)).value()?this.trigger("sync:queue",this,t):void 0},n.prototype.linkFrom=function(e){return e===this.fromNode?this:(this.previousFromNode=this.fromNode,this.listenOff(this.fromNode),this.fromNode=e,this.listenOn(this.fromNode),this.set("from_node_index",e?e.get("index"):-1),bt.init&&(null!=this.previousFromNode&&(this.previousFromNode.trigger("check"),this.previousFromNode.updateEdgesPosition()),null!=this.fromNode&&(this.fromNode.trigger("check"),this.fromNode.updateEdgesPosition())),this)},n.prototype.linkTo=function(e){var t;return e===this.fromNode||e===this.toNode?this:(t=this.toNode,this.listenOff(this.toNode),this.toNode=e,this.listenOn(this.toNode),this.set("to_node_index",e?e.get("index"):-1),bt.init&&(this.fromNode.trigger("check"),null!=t&&t.trigger("check"),null!=e&&e.trigger("check")),this)},n.prototype.listenOn=function(e){return null!=e?(this.listenTo(e,"change:top change:left",this.redraw),this.listenTo(e,"saved",this.save)):void 0},n.prototype.listenOff=function(e){return null!=e?this.stopListening(e):void 0},n.prototype.useless=function(){return!this.get("content")&&!this.get("to_node_index")},n.prototype.redraw=function(){return this.trigger("redraw")},n.prototype.checkParentNode=function(){return this.fromNode.trigger("check")},n.prototype.broken=function(){var e;return e=[],this.get("content")||e.push("There is an empty reply option"),this.toNode||e.push("One of the reply options leads nowhere"),e},n.prototype.serverAttributes=function(){return this.sensitiveAttributes.concat(["id"])},n.prototype.toJSON=function(e){var t;return e||(e={}),t=e.server?this.pick(this.serverAttributes()):_.clone(this.attributes)},n.prototype.eventJSON=function(){return this.pick(["content","from_node_index","to_node_index","index","position"])},n.prototype.filename=function(){var e;return e=this.get("index"),this.fromNode.filename()+"E"+(10>e?"0"+e:e)},n.prototype.parse=function(e){return null!=e.edge?e.edge:e},n.prototype["delete"]=function(){return this.set("deleted",!0),this.project.edges.remove(this),this.off(),this.fromNode.get("deleted")?void 0:this.fromNode.updateEdgesPosition()},n.prototype.getContent=function(){return this.get("content")?this.get("content"):"no reply text"},n.prototype.getVoiceURL=function(){var e;return e=bt.project.voices.get(this.get("voice_id")),null!=e?e.get("url"):void 0},n}(Backbone.Model),Branchtrack.Collections.Edges=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=Branchtrack.Models.Edge,i.prototype.parse=function(e){return null!=e.edges?e.edges:e},i.prototype.create=function(e,t){var i;return null==t&&(t={}),e.index||(e.index=bt.project.nextEdgeIndex()),i=new Branchtrack.Models.Edge(e,t),this.add(i,t),i},i}(Backbone.Collection)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty;Branchtrack.Models.FeatureSet=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.has=function(e){return!!this.get(e)||!!this.get("all")},i}(Backbone.Model)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Models.Node=function(i){function n(){return this.check=e(this.check,this),this.afterChange=e(this.afterChange,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.className="Node",n.prototype.sensitiveAttributes=["index","deleted","content","top","left","emotion","feedback","score","color","character_id","background_id","character_behavior","background_behavior","voice_id","video_id","default_edge_index","show_edges_delay"],n.prototype.defaults={index:0,content:"",top:0,left:0,score:0,emotion:"normal",color:"",deleted:!1,feedback:"",unresolved_comments_count:0,default_edge_index:null,show_edges_delay:null},n.prototype.initialize=function(e,t){return null==t&&(t={}),this.project=bt.project,e.index||console.error("Undefined attribute 'index' for Node"),this.on("change",this.afterChange),this.on("change:content check",this.check),this.on("change:video_id",this.updateEdgesDelay),this.listenTo(this.project,"init",this.updateEdgesPosition)},n.prototype.url=function(){return this.project.url()+"/nodes"+(this.isNew()?"":"/"+this.id)},n.prototype.afterChange=function(e,t){return null==t&&(t={}),t.bayeux?void 0:_.chain(this.changedAttributes()).keys().any(function(e){return function(t){return _(e.sensitiveAttributes).indexOf(t)>-1}}(this)).value()?this.trigger("sync:queue",this,t):void 0},n.prototype.edges=function(e){var t,i;switch(null==e&&(e="out"),i=this.get("index"),t=[],e){case"all":t=this.project.edges.filter(function(e){return e.get("to_node_index")===i||e.get("from_node_index")===i});break;case"in":t=this.project.edges.where({to_node_index:i});break;default:t=_(this.project.edges.where({from_node_index:i})).sortBy(function(e){return e.get("position")})}return _(t)},n.prototype.createEdge=function(e){var t;return null==e&&(e={}),t=this.project.edges.create(e,{fromNode:this}),t.set("position",this.edges().size()),t},n.prototype.redrawEdges=function(){return this.edges("all").forEach(function(e){return e.trigger("redraw")})},n.prototype.updateEdgesPosition=function(){var e;return e=1,this.edges().each(function(t){return t.set("position",e++)})},n.prototype.updateEdgesDelay=function(e){var t;return null==e&&(e=parseInt(this.get("show_edges_delay"),10)),t=this.project.videos.get(this.get("video_id")),null!=t?((isNaN(e)||0>e||e>t.get("duration"))&&(e=Math.floor(t.get("duration")/2)),this.set("show_edges_delay",e)):void 0},n.prototype.useless=function(){return!this.get("content")&&0===this.edges().size()},n.prototype["delete"]=function(){return this.set("deleted",!0),this.edges("out").each(function(e){return e["delete"]()}),this.edges("in").each(function(e){return e.linkTo(null)}),this.project.nodes.remove(this),this.off()},n.prototype.isInitial=function(){return this.get("index")===this.project.get("initial_node_index")},n.prototype.check=function(){var e;return e=[],this.get("content")||this.get("video_id")||e.push("What does the character say?"),this.isInitial()||0!==this.edges("in").size()||e.push("There are no links leading to this scene"),e=_(e).union(_.chain(this.edges()).map(function(e){return e.broken()}).flatten().compact().value()),this.trigger("broken",e),!e.length},n.prototype.serverAttributes=function(){return this.sensitiveAttributes.concat(["id"])},n.prototype.toJSON=function(e){var t;return e||(e={}),t=e.server?this.pick(this.serverAttributes()):_.clone(this.attributes)},n.prototype.eventJSON=function(){return this.pick(["content","feedback","index","score","emotion"])},n.prototype.filename=function(){var e;return e=this.get("index"),"S"+(10>e?"0"+e:e)},n.prototype.parse=function(e){return e.node},n.prototype.getContent=function(){return this.get("content")?this.get("content"):"Scene #"+this.get("index")},n.prototype.getEmotion=function(){return this.get("emotion")||Branchtrack.Models.Node.prototype.defaults.emotion},n.prototype.getCharacterEmotion=function(){var e,t;return(e=this.get("character"))?(t=e.emotional?this.get("emotion"):null,t||(t=Branchtrack.Models.Node.prototype.defaults.emotion),e.emotions[t]):{}},n.prototype.getBackground=function(){return this.get("background")||{}},n.prototype.getVoiceURL=function(){var e;return e=bt.project.voices.get(this.get("voice_id")),null!=e?e.get("url"):void 0},n.prototype.getVideoURL=function(){var e;return e=bt.project.videos.get(this.get("video_id")),null!=e?e.get("url"):void 0},n.prototype.getEdgesDelay=function(){var e,t,i;return e=parseInt(this.get("show_edges_delay"),10),isNaN(e)?"":(t=Math.floor(e/60),i=Math.round(e%60),t=10>t?"0"+t:t,i=10>i?"0"+i:i,t+":"+i)},n.prototype.getDefaultEdge=function(){var e;return e=this.get("default_edge_index"),e?bt.project.edges.findWhere({index:this.get("default_edge_index")}):void 0},n.prototype.getMaxAnswersCount=function(){return this.maxAnswersCount||(this.maxAnswersCount=this.edges().max(function(e){return e.get("answers_count")}).get("answers_count")||0)},n.prototype.getTotalAnswersCount=function(){return this.totalAnswersCount||(this.totalAnswersCount=this.edges().reduce(function(e,t){return e+(t.get("answers_count")||0)},0))},n}(Backbone.Model),Branchtrack.Collections.Nodes=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.model=Branchtrack.Models.Node,i.prototype.create=function(e,t){var i;return null==t&&(t={}),e.index||(e.index=bt.project.nextNodeIndex()),i=new Branchtrack.Models.Node(e,t),this.add(i,t),i},i}(Backbone.Collection)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Models.Project=function(i){function n(){return this.checkInitialNode=e(this.checkInitialNode,this),this.setInitialNode=e(this.setInitialNode,this),this.afterChange=e(this.afterChange,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.className="Project",n.prototype.idAttribute="permalink",n.prototype.urlRoot="/editor/projects",n.prototype.sensitiveAttributes=["title","initial_node_index","background_id","character_id","theme_id","enable_emotion_meter","disable_copyright_logo","workspace_top","workspace_left","live","private"],n.prototype.EMBED_WIDTH=800,n.prototype.EMBED_HEIGHT=500,n.prototype.EMBED_MINWIDTH=440,n.prototype.EMBED_MINHEIGHT=370,n.prototype.defaults={title:"",center_left:0,center_top:0,workspace_width:0,workspace_height:0,workspace_top:0,workspace_left:0,initial_node_index:null,zoom:{index:0,value:1},next_node_index:1,next_edge_index:1,character_id:null,background_id:null,enable_emotion_meter:!0,disable_copyright_logo:!1,live:!0},n.prototype.initialize=function(e,t){var i,n,o,r;return null==t&&(t={}),bt.project=this,n=this.get("nodes"),i=this.get("edges"),r=this.get("voices"),o=this.get("videos"),this.unset("nodes"),this.unset("edges"),this.unset("voices"),this.unset("videos"),this.nodes=new Branchtrack.Collections.Nodes(n),this.edges=new Branchtrack.Collections.Edges(i),this.voices=new Branchtrack.Collections.Voices(r),this.videos=new Branchtrack.Collections.Videos(o),this.on("change",this.afterChange),this.nodes.on("add remove",this.checkInitialNode),this.nodes.on("initial",this.setInitialNode),this.trigger("init")},n.prototype.serverAttributes=function(){return this.sensitiveAttributes.concat(["id","center_top","center_left","workspace_width","workspace_height","parent_id"])},n.prototype.toJSON=function(e){var t;return e||(e={}),t=e.server?this.pick(this.serverAttributes()):_.clone(this.attributes)},n.prototype.eventJSON=function(){return this.pick(["permalink","embed_id","embed_url","embed_code","json_url","title","url","zip_url"])},n.prototype.parse=function(e,t){return null==t&&(t={}),e.project},n.prototype.afterChange=function(e,t){return null==t&&(t={}),t.bayeux?void 0:_.chain(this.changedAttributes()).keys().any(function(e){return function(t){return _(e.sensitiveAttributes).indexOf(t)>-1}}(this)).value()?this.trigger("sync:queue",this,t):void 0},n.prototype.setInitialNode=function(e){var t,i;return i=this.nodes.findWhere({index:this.get("initial_node_index")}),t=e&&e.get("index")||null,this.set("initial_node_index",t),null!=i&&i.trigger("check"),null!=e?e.trigger("check"):void 0},n.prototype.checkInitialNode=function(e){return this.get("initial_node_index")?this.get("initial_node_index")===e.get("index")&&e.get("deleted")?(e=this.nodes.first(),this.set("initial_node_index",e?e.get("index"):0)):void 0:(this.set("initial_node_index",e.get("index")),e.trigger("check"))},n.prototype.reset=function(){return this.set(this.defaults,{silent:!0}),this.nodes.reset([]),this.edges.reset([])},n.prototype.nextNodeIndex=function(){var e;return e=parseInt(this.get("next_node_index"),10)||1,this.set("next_node_index",e+1),e},n.prototype.nextEdgeIndex=function(){var e;return e=parseInt(this.get("next_edge_index"),10)||1,this.set("next_edge_index",e+1),e},n.prototype.getTitle=function(){return this.get("title")||"No title"},n.prototype.getCharacterEmotion=function(e){var t;return(t=this.get("character"))?(t.emotional||(e=null),e||(e=Branchtrack.Models.Node.prototype.defaults.emotion),t.emotions[e]):{}},n.prototype.getBackground=function(){return this.get("background")||{}},n.prototype.loadStats=function(){return this._statsLoaded?!1:(this.edges.fetch({url:this.url()+"/stats",complete:function(e){return function(){return e._statsLoaded=!0,Branchtrack.Events.trigger("editor:stats:loaded")}}(this)}),!0)},n}(Backbone.Model)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty;Branchtrack.Models.Reviewer=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.className="Reviewer",i.prototype.defaults={id:null,email:"",revoked:!1},i.prototype.parse=function(e){return null!=e.reviewer?e.reviewer:e},i.prototype.toJSON=function(e){return{reviewer:i.__super__.toJSON.call(this,e)}},i.prototype.urlForCommenting=function(){return"/editor/reviewers/"+this.get("token")},i}(Backbone.Model),Branchtrack.Collections.Reviewers=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.model=Branchtrack.Models.Reviewer,i.prototype.url=function(){return bt.project.url()+"/reviewers"},i.prototype.parse=function(e){return e.reviewers},i.prototype.success=function(e){var t;return t=this.parse(e),this.set(t,{remove:!1})},i.prototype.invite=function(e){return $.ajax({url:this.url(),method:"post",dataType:"json",data:{reviewers:{emails:e}},success:function(e){return function(t){return e.success(t),e.trigger("invite:success",t)}}(this),error:function(e){return function(){return e.trigger("invite:error")
}}(this)})},i}(Backbone.Collection)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty;Branchtrack.Models.Survey=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.className="Survey",i.prototype.persistable=!0,i.prototype.initialize=function(e,t){return null==t&&(t={}),this.project=bt.project,null!=t.persistable&&(this.persistable=t.persistable),this.timeline=new Branchtrack.Collections.Timeline([]),this.listenTo(this.timeline,"add",this.timelineEntryAdded),this},i.prototype.url=function(){return bt.url.root+this.project.url()+"/surveys"+(this.id?"/"+this.id:"")},i.prototype.reset=function(){return this.unset("id"),this.timeline.reset()},i.prototype.start=function(e){return this.set("started_at",new Date),e||(e=this.project.nodes.findWhere({index:this.project.get("initial_node_index")})),e?this.timeline.add({},{parent:e}):void 0},i.prototype.finish=function(){return this.set("finished_at",new Date),this.save()},i.prototype.questions=function(){return _(this.timeline.filter(function(e){return e instanceof Branchtrack.Models.TimelineNode}))},i.prototype.answers=function(){return _(this.timeline.filter(function(e){return e instanceof Branchtrack.Models.TimelineEdge}))},i.prototype.createTimelineNode=function(e){return this.timeline.create(e)},i.prototype.createTimelineEdge=function(e){return this.timeline.create(e)},i.prototype.lastTimelineNode=function(){return this.questions().last()},i.prototype.lastTimelineEdge=function(){return this.answers().last()},i.prototype.lastNode=function(){return this.lastTimelineNode().parent},i.prototype.save=function(){return this.persistable?i.__super__.save.call(this,null,{namespace:!0}):!1},i.prototype.timelineEntryAdded=function(e){return e instanceof Branchtrack.Models.TimelineNode&&0===e.parent.edges().size()?this.finish():void 0},i.prototype.toJSON=function(e){var t;return null==e&&(e={}),t=_.clone(this.attributes),t.answers=this.answers().map(function(e){return e.toJSON()}),t.referrer_url=window.location!==window.parent.location?document.referrer:window.location.href,e.namespace&&(t={survey:t}),t},i.prototype.eventJSON=function(){var e;return e=_.clone(this.attributes),e=this.timeline.map(function(e){return e.eventJSON()})},i}(Backbone.Model)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty;Branchtrack.Models.Theme=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.className="Theme",i.prototype.defaults={id:null,name:"Default",bg_color:"#372630",speech_bg_color:"#ffffff",speech_opacity:.95,answer_bg_color:"#ffffff",answer_opacity:.6,highlight_bg_color:"#cc3232",font_face:"Open Sans",logo_url:null,logo_name:"",font_color:"#000000"},i.prototype.names={bg_color:"Background color",speech_bg_color:"Speech bubble color",speech_opacity:"Speech bubble opacity",answer_bg_color:"Choice and feedback background color",answer_opacity:"Choice and feedback opacity",highlight_bg_color:"Highlight color",font_face:"Font family",font_color:"Font color",logo:"Logo"},i.prototype.tips={bg_color:"We will disable this color when you close this tab.<br>Don't worry, it will be saved and displayed to the learners.",font_face:"Have a special font request? Ask us.",highlight_bg_color:"This is the color of choice numbers, score badges and other UI elements that are red by default."},i.prototype.url=function(){return"/editor/themes"+(this.isNew()?"":"/"+this.id)},i.prototype.parse=function(e){return null!=e.theme?e.theme:e},i.prototype.toJSON=function(){return{theme:i.__super__.toJSON.apply(this,arguments)}},i}(Backbone.Model),Branchtrack.Collections.Themes=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.url="/editor/themes",i.prototype.model=Branchtrack.Models.Theme,i.prototype.fonts=[],i.prototype.parse=function(e){return e.fonts&&(this.fonts=e.fonts),e.themes},i}(Backbone.Collection)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty,i=function(e,t){return function(){return e.apply(t,arguments)}};Branchtrack.Models.TimelineEdge=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.className="Edge",i.prototype.initialize=function(e,t){return null==t&&(t={}),this.parent=t.parent,this.set("answered_at",new Date),this},i.prototype.getVoiceURL=function(){return this.parent.getVoiceURL()},i.prototype.toJSON=function(e){var t;return null==e&&(e={}),t=_.clone(this.attributes),t.edge_id=this.parent.id,t.from_node_id=this.parent.get("from_node_id"),t.to_node_id=this.parent.get("to_node_id"),t},i.prototype.eventJSON=function(){var e;return e=this.parent.eventJSON(),e.answered_at=this.get("answered_at"),e.time=this.get("time"),e},i}(Backbone.Model),Branchtrack.Models.TimelineNode=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.className="Node",i.prototype.initialize=function(e,t){return t||(t={}),this.parent=t.parent,this},i.prototype.getVoiceURL=function(){return this.parent.getVoiceURL()},i.prototype.getVideoURL=function(){return this.parent.getVideoURL()},i.prototype.toJSON=function(e){var t;return null==e&&(e={}),t=_.clone(this.attributes),t.node_id=this.parent.id,t},i.prototype.eventJSON=function(){return this.parent.eventJSON()},i}(Backbone.Model),Branchtrack.Collections.Timeline=function(t){function n(){return this.setTime=i(this.setTime,this),n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.initialize=function(e,t){return null==t&&(t={}),this.time=new Date,this.on("add",this.setTime),this},n.prototype.model=function(e,t){return null==t&&(t={}),t.parent instanceof Branchtrack.Models.Edge?new Branchtrack.Models.TimelineEdge(e,t):t.parent instanceof Branchtrack.Models.Node?new Branchtrack.Models.TimelineNode(e,t):void 0},n.prototype.create=function(e){return this.add({},{parent:e})},n.prototype.setTime=function(e){return e instanceof Branchtrack.Models.TimelineNode?this.time=new Date:e.set("time",new Date-this.time)},n}(Backbone.Collection)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty,i=function(e,t){return function(){return e.apply(t,arguments)}};Branchtrack.Models.Video=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.className="Video",i.prototype.defaults={url:"",duration:0},i.prototype.getDuration=function(){var e,t,i;return e=this.get("duration")||0,t=Math.floor(e/60),i=Math.round(e%60),t=10>t?"0"+t:t,i=10>i?"0"+i:i,t+":"+i},i.prototype.parse=function(e){return null!=e.video?e.video:e},i}(Backbone.Model),Branchtrack.Collections.Videos=function(t){function n(){return this.deleteError=i(this.deleteError,this),this.deleteSuccess=i(this.deleteSuccess,this),n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Branchtrack.Models.Video,n.prototype.url=function(){return bt.project.url()+"/videos"},n.prototype.parse=function(e){return e.videos},n.prototype.deleteAll=function(){return this.trigger("deleting"),$.ajax({url:this.url(),method:"DELETE",error:this.deleteError,success:this.deleteSuccess,contentType:"application/json",dataType:"json"})},n.prototype.deleteSuccess=function(){return bt.project.nodes.each(function(e){return e.set("video_id",null)}),this.reset([]),this.trigger("deleting:success")},n.prototype.deleteError=function(){return this.trigger("deleting:error")},n}(Backbone.Collection)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty,i=function(e,t){return function(){return e.apply(t,arguments)}};Branchtrack.Models.Voice=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.className="Voice",i.prototype.defaults={url:""},i.prototype.parse=function(e){return null!=e.voice?e.voice:e},i}(Backbone.Model),Branchtrack.Collections.Voices=function(t){function n(){return this.deleteError=i(this.deleteError,this),this.deleteSuccess=i(this.deleteSuccess,this),n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=Branchtrack.Models.Voice,n.prototype.url=function(){return bt.project.url()+"/voices"},n.prototype.parse=function(e){return e.voices},n.prototype.deleteAll=function(){return this.trigger("deleting"),$.ajax({url:this.url(),method:"DELETE",error:this.deleteError,success:this.deleteSuccess,contentType:"application/json",dataType:"json"})},n.prototype.deleteSuccess=function(){return bt.project.nodes.each(function(e){return e.set("voice_id",null)}),bt.project.edges.each(function(e){return e.set("voice_id",null)}),this.reset([]),this.trigger("deleting:success")},n.prototype.deleteError=function(){return this.trigger("deleting:error")},n}(Backbone.Collection)}.call(this),function(){return this.JST||(this.JST={}),this.JST["player/templates/edges/show"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var o;return'<div class="edge theme-answer-bg-color">\n  <em class="edge-position theme-highlight-bg-color">'+this.escapeExpression((o=null!=(o=t.position||(null!=e?e.position:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"position",hash:{},data:n}):o))+'</em>\n  <span class="content"></span>\n  <span class="edge-tick theme-answer-border-color"></span>\n</div>'},useData:!0}),this.JST["player/templates/edges/show"]}.call(this),function(){return this.JST||(this.JST={}),this.JST["player/templates/edges/timeline"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var o;return'<cite class="theme-answer-bg-color">\n  <em class="edge-position theme-highlight-bg-color">'+this.escapeExpression((o=null!=(o=t.position||(null!=e?e.position:e))?o:t.helperMissing,"function"==typeof o?o.call(e,{name:"position",hash:{},data:n}):o))+'</em>\n  <span class="content theme-highlight-anchor-color"></span>\n  <span class="edge-tick theme-answer-border-color"></span>\n</cite>'},useData:!0}),this.JST["player/templates/edges/timeline"]}.call(this),function(){return this.JST||(this.JST={}),this.JST["player/templates/emotion_meter"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="track">\n  <div class="thumb"></div>\n</div>\n  <span class="bt-emotion happy">\n    <span>Happy</span>\n  </span>\n  <span class="bt-emotion normal">\n    <span>Normal</span>\n  </span>\n  <span class="bt-emotion puzzled">\n    <span>Puzzled</span>\n  </span>\n  <span class="bt-emotion unhappy">\n    <span>Unhappy</span>\n  </span>\n  <span class="bt-emotion angry">\n    <span>Angry</span>\n  </span>'},useData:!0}),this.JST["player/templates/emotion_meter"]}.call(this),function(){return this.JST||(this.JST={}),this.JST["player/templates/nodes/feedback"]=Handlebars.template({1:function(){return'  <a href="#" class="icon close"></a>\n'},3:function(){return'      <a href="" class="icon replay">play again</a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var o;return(null!=(o=t["if"].call(e,null!=e?e.close:e,{name:"if",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?o:"")+'<table class="theme-answer-bg-color">\n  <th>\n    <div class="theme-highlight-bg-color">\n      <small>your score is</small>\n      <em class="score">0</em>\n      <small>out of 100</small>\n    </div>\n  </th>\n  <td>\n    <div class="text"></div>\n'+(null!=(o=t["if"].call(e,null!=e?e.replay:e,{name:"if",hash:{},fn:this.program(3,n,0),inverse:this.noop,data:n}))?o:"")+'    <a href="javascript:;" class="button continue theme-highlight-bg-color">continue</a>\n  </td>\n</table>'},useData:!0}),this.JST["player/templates/nodes/feedback"]}.call(this),function(){return this.JST||(this.JST={}),this.JST["player/templates/nodes/timeline"]=Handlebars.template({1:function(){return'    <a href="javascript:;" class="media-icon control-video fa fa-video-camera"></a>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,n){var o;return'<blockquote class="theme-speech-bg-color">\n'+(null!=(o=t["if"].call(e,null!=e?e.video_url:e,{name:"if",hash:{},fn:this.program(1,n,0),inverse:this.noop,data:n}))?o:"")+'  <span class="content theme-highlight-anchor-color"></span>\n  <span class="node-tick theme-speech-border-color"></span>\n</blockquote>'},useData:!0}),this.JST["player/templates/nodes/timeline"]}.call(this),function(){return this.JST||(this.JST={}),this.JST["player/templates/player"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="player-logo">\n  <a href="javascript:;" target="_blank"><img src="assets/player/logo-dc45f723d5071e18c7fba0db00b9ae5a.png"></a>\n  <span>created in <a href="javascript:;" target="_blank">BranchTrack</a></span>\n</div>\n<div class="player-backgrounds"></div>\n<div class="player-characters"></div>\n<div class="player-edges"></div>\n<div class="player-feedbacks"></div>'},useData:!0}),this.JST["player/templates/player"]}.call(this),function(){return this.JST||(this.JST={}),this.JST["player/templates/video"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="media-control">\n  <video preload="auto" class="mejs-bt" width="100%" height="100%" style="width: 100%; height: 100%;"></video>\n</div>'},useData:!0}),this.JST["player/templates/video"]}.call(this),function(){return this.JST||(this.JST={}),this.JST["player/templates/voice"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="volume">\n  <a href="javascript:;" class="media-icon control-volume fa theme-highlight-bg-color"></a>\n</div>\n<div class="media-control">\n  <audio class="mejs-bt" width="100%" height="20"></audio>\n</div>'},useData:!0}),this.JST["player/templates/voice"]}.call(this),function(){return this.JST||(this.JST={}),this.JST["player/templates/voices/timeline"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div class="voice">\n  <div class="track">\n    <div class="progress theme-highlight-bg-color"></div>\n  </div>\n  <a href="javascript:;" class="media-icon control-voice fa fa-play theme-highlight-bg-color"></a>\n</div>'},useData:!0}),this.JST["player/templates/voices/timeline"]}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty;Branchtrack.Views.Player.EdgeShowView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.template=JST["player/templates/edges/show"],i.prototype.tagName="li",i.prototype.events={"click div.edge":"navigateNext"},i.prototype.initialize=function(){return this.listenTo(this.model,"change:content",this.renderContent),this.listenTo(this.model,"change:position",this.renderPosition),this},i.prototype.render=function(){var e;return e=_.clone(this.model.attributes),this.$el.html(this.template(e)),this.renderContent(),this.append(),this.listenTo(this.model,"change:from_node_index",this.append),this},i.prototype.append=function(){var e;return null!=this.el.parentNode&&this.$el.detach(),e=Branchtrack.Views.get(this.model.fromNode,"player/edges").$el,this.$el.appendTo(e)},i.prototype.renderContent=function(){var e;return e=$("<div>"+this.model.getContent()+"<div>").text(),this.$(".content").html(e.replace(/\n{2,}/g,"<br><br>").replace(/\n/g,"<br>"))},i.prototype.renderPosition=function(){return this.$("em").text(this.model.get("position"))},i.prototype.position=function(){var e,t;return t=this.$el.parent().position(),e=this.$el.position(),{top:t.top+e.top,left:t.left+e.left}},i.prototype.offset=function(){return this.$el.offset()},i.prototype.navigateNext=function(e){return null!=e&&e.preventDefault(),bt.survey.createTimelineEdge(this.model)},i}(Backbone.View)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty;Branchtrack.Views.Player.EmotionMeterView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.template=JST["player/templates/emotion_meter"],i.prototype.className="player-emotion-meter",i.prototype.initialize=function(e){return this.project=bt.project,this.container=e.container,this},i.prototype.render=function(){return this.$el.html(this.template()),this.toggle(),this.$el.prependTo(this.container),this.listenTo(this.project,"change:enable_emotion_meter",this.toggle),this.listenTo(this.project.nodes,"change:emotion",this.update),this.listenTo(Branchtrack.Events,"player:timeline:node",this.update),this},i.prototype.toggle=function(){return this.$el.toggleClass("visible",this.project.get("enable_emotion_meter"))},i.prototype.currentNode=function(){var e;return e=bt.survey.questions().last(),e?e.parent:null},i.prototype.update=function(){var e,t;return t=this.currentNode(),t?(e=t.getEmotion(),this.$el.find(".bt-emotion.active").removeClass("active"),this.$el.find(".bt-emotion."+e).addClass("active"),this.$el.find(".track").attr("class","track "+e)):void 0},i}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Views.Player.NodeEdgesView=function(i){function n(){return this.hotkey=e(this.hotkey,this),this.addEdge=e(this.addEdge,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.tagName="ol",n.prototype.className="edges",n.prototype.container="div.player-edges",n.prototype.events={},n.prototype.initialize=function(){return this},n.prototype.render=function(){return this.$el.parent().length>0?!1:(this.renderEdges(),this.$el.appendTo(this.container),this.listenTo(this.model,"player:edges:show",this.show),this.listenTo(this.model,"player:edges:hide",this.hide),this.listenTo(this.model,"edges:reposition",this.repositionEdges),this.listenTo(this.model.project.edges,"add",this.addEdge),this.listenTo(this.model.project.edges,"remove",this.removeEdge),this.listenTo(Branchtrack.Events,"player:reset",this.reset),this)},n.prototype.renderEdges=function(){return this.model.edges().each(this.addEdge)},n.prototype.addEdge=function(e){return e.fromNode===this.model?Branchtrack.Views.get(e,"player/show").render():void 0},n.prototype.removeEdge=function(e){return e.fromNode===this.model?Branchtrack.Views.remove(e,"player/show"):void 0},n.prototype.repositionEdges=function(){return this.model.edges().each(function(e){return Branchtrack.Views.get(e,"player/show").append()})},n.prototype.reset=function(){return this.hide()},n.prototype.hide=function(){return this.$el.velocity("stop").velocity({opacity:0,bottom:-this.$el.height()},{display:"none"}),this.disableHotkeys()},n.prototype.show=function(){return this.$el.css({bottom:0,left:-this.$el.width()}).velocity("stop").velocity({opacity:1,left:0},{display:"block"}),Branchtrack.Events.trigger("player:voice:hide"),this.enableHotkeys()},n.prototype.hotkey=function(e){var t,i;return e.which>48&&e.which<=57&&(t=e.which-48,i=this.model.edges().find(function(e){return e.get("position")===t}))?(bt.survey.createTimelineEdge(i),this.disableHotkeys()):void 0},n.prototype.enableHotkeys=function(){return this.disableHotkeys(),$(document).on("keyup",null,"1 2 3 4 5 6 7 8 9 0",this.hotkey)},n.prototype.disableHotkeys=function(){return $(document).off("keyup",this.hotkey)},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Views.Player.NodeFeedbackView=function(i){function n(){return this.hotkey=e(this.hotkey,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.template=JST["player/templates/nodes/feedback"],n.prototype.tagName="div",n.prototype.className="feedback",n.prototype.container="div.player-feedbacks",n.prototype.events={"click a.continue":"continue","click a.close":"continue"},n.prototype.initialize=function(){return this.visible=!1,this},n.prototype.render=function(){return this.$el.parent().length>0?!1:(this.$el.html(this.template()),this.$el.css("visibility","hidden").appendTo(this.container),this.$text=this.$(".text"),this.$score=this.$(".score"),this.renderContent(),this.listenTo(this.model,"change:feedback change:score",this.renderContent),this.listenTo(this.model,"player:feedback:show",this.show),this.listenTo(this.model,"player:feedback:hide",this.hide),this.listenTo(Branchtrack.Events,"player:reset",this.reset),this)},n.prototype.reset=function(){return this.visible=!1,this.$el.velocity("stop").velocity({opacity:0,top:0},{display:"none"})},n.prototype.show=function(){return this.visible?!1:(this.visible=!0,this.$el.velocity("stop").velocity({opacity:1,top:-245},{display:"block",visibility:"visible"}),this.enableHotkeys())},n.prototype.hide=function(e){return this.visible?(this.visible=!1,this.disableHotkeys(),this.$el.velocity("stop").velocity({opacity:0,top:0},{display:"none",complete:e})):!1},n.prototype["continue"]=function(){return this.hide(this.model.trigger("player:feedback:continue"))},n.prototype.renderContent=function(){var e,t,i,n,o;return n=parseInt(this.model.get("score")),e=$("<div>"+this.model.get("feedback")+"</div>").text(),e=e.replace(/\n{2,}/g,"<br><br>").replace(/\n/g,"<br>"),t=48,i=180,0===this.model.edges().size()?this.$el.addClass("finish"):(this.$el.removeClass("finish"),i-=70),n>0?(this.$el.addClass("with-score"),this.$score.text(n)):this.$el.removeClass("with-score"),o=this.$text.width(),t=Branchtrack.Helpers.fontSize(e,{minSize:14,maxSize:50,size:t,width:o,height:i,css:{fontFamily:this.$el.css("font-family"),fontWeight:this.$el.css("font-weight")}}),this.$text.css({fontSize:t}).html(e.autoLink({target:"_blank",rel:"nofollow"}))},n.prototype.hotkey=function(){return this["continue"]()},n.prototype.enableHotkeys=function(){return this.disableHotkeys(),$(document).on("keyup",null,"space",this.hotkey)},n.prototype.disableHotkeys=function(){return $(document).off("keyup",this.hotkey)},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Views.Player.PlayerView=function(i){function n(){return this.hotkey=e(this.hotkey,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.template=JST["player/templates/player"],n.prototype.className="player",n.prototype.events={"click a.replay":"reset","mouseenter div.player-logo":"hoverLogo","mouseleave div.player-logo":"blurLogo"},n.prototype.autostart=!0,n.prototype.node=null,n.prototype.initialize=function(e){return null==e&&(e={}),this.$window=$(window),bt.player||(bt.player={}),this.editor=null!=e.persistable?!e.persistable:!1,this.project=bt.project,this.setElement(e.embed_el?e.embed_el:document.getElementById(this.project.get("embed_id"))),this.survey=bt.survey=new Branchtrack.Models.Survey({},{persistable:!this.editor}),null!=e.autostart&&(this.autostart=e.autostart),Branchtrack.dispatchEvent("player:init",{project:this.project.eventJSON()}),this},n.prototype.render=function(){var e;return e=_.clone(this.project.attributes),this.$el.addClass(this.className),this.$el.get(0).innerHTML=this.template(e),this.$logo=this.$("div.player-logo"),this.$logo.find("a").attr("href",bt.url.root),this.$timeline=this.$("ul.player-timeline"),this.$backgrounds=this.$("div.player-backgrounds"),this.$characters=this.$("div.player-characters"),this.toggleCopyrightLogo(),new Branchtrack.Views.Player.TimelineView({container:this.el,collection:this.survey.timeline}).render(),new Branchtrack.Views.Player.EmotionMeterView({container:this.el}).render(),new Branchtrack.Views.Player.VoicePlayerView({container:this.el,autoplay:!this.editor}).render(),new Branchtrack.Views.Player.VideoPlayerView({container:this.el,autoplay:!this.editor}).render(),this.listenTo(this.project,"change:background_id",this.renderBackground),this.listenTo(this.project,"change:character_id",this.renderCharacter),this.listenTo(this.project,"change:disable_copyright_logo",this.toggleCopyrightLogo),this.listenTo(this.project.nodes,"remove",this.removeNode),this.listenTo(this.project.nodes,"change:character_id change:character_behavior change:emotion",this.renderCharacter),this.listenTo(this.project.nodes,"change:background_id change:background_behavior",this.renderBackground),this.listenTo(Branchtrack.Events,"player:reset",this.reset),this.listenTo(Branchtrack.Events,"player:start",this.start),this.listenTo(Branchtrack.Events,"player:goto",this["goto"]),this.listenTo(Branchtrack.Events,"player:reverse",this.reverse),this.listenTo(Branchtrack.Events,"player:timeline:node",this.renderMedia),this.listenTo(Branchtrack.Events,"player:video:controls",this.videoControlsBehavior),this.enableHotkeys(),this.autostart&&this.reset().start(),this},n.prototype.renderMedia=function(){return bt.player.node=this.survey.lastNode(),this.renderBackground(),this.renderCharacter()},n.prototype.renderBackground=function(){var e,t,i,n,o;if(!bt.player.node)return!1;switch(bt.player.node.get("background_behavior")){case"default":bt.player.background=this.project.getBackground();break;case"selected":bt.player.background=bt.player.node.getBackground();break;default:if(!bt.player.node.isInitial())return!0;bt.player.background=this.project.getBackground()}return i=bt.player.background?bt.player.background.player_url:!1,i!==this.backgroundURL?(this.backgroundURL=i,e=this.$backgrounds.children().not(".hidden"),o=function(){return e.addClass("hidden").velocity({opacity:0},{complete:function(){return $(this).remove()}})},i?(t=$('<div class="background">').css({opacity:0}).appendTo(this.$backgrounds),n=new Image,n.onload=function(){return o(),t.css("background-image",'url("'+n.src+'")').velocity({opacity:1})},n.src=i):o()):void 0},n.prototype.renderCharacter=function(){var e,t,i,n,o,r;if(!bt.player.node)return!1;switch(n=bt.player.node.getEmotion(),bt.player.node.get("character_behavior")){case"default":bt.player.character=this.project.get("character"),bt.player.emotion=this.project.getCharacterEmotion(n);break;case"selected":bt.player.character=bt.player.node.get("character"),bt.player.emotion=bt.player.node.getCharacterEmotion();break;default:bt.player.node.isInitial()?(bt.player.character=this.project.get("character"),bt.player.emotion=this.project.getCharacterEmotion(n)):bt.player.character&&(bt.player.character.emotional||(n=null),n||(n=Branchtrack.Models.Node.prototype.defaults.emotion),bt.player.emotion=bt.player.character.emotions[n])}return i=bt.player.emotion?bt.player.emotion.player_url:!1,i!==this.characterURL?(this.characterURL=i,e=this.$characters.children().not(".hidden"),r=function(){return e.addClass("hidden").velocity({opacity:0},{complete:function(){return $(this).remove()}})},i?(t=$('<div class="character big">').css({opacity:0}).appendTo(this.$characters),o=new Image,o.onload=function(){return r(),bt.player.node.trigger("player:character:changed"),t.css("background-image",'url("'+o.src+'")').velocity({opacity:1})},o.src=i):r()):void 0},n.prototype.toggleCopyrightLogo=function(){return this.$logo.toggleClass("visible",!this.project.get("disable_copyright_logo"))},n.prototype.reset=function(){return this.survey.reset(),this},n.prototype.start=function(e){return 0===this.survey.timeline.length&&(Branchtrack.dispatchEvent("player:start",{project:this.project.eventJSON()}),this.survey.start(e)),this},n.prototype.removeNode=function(e){return Branchtrack.Views.remove(e,"player/edges")},n.prototype.reverse=function(){var e,t;return this.survey.questions().size()>1?(t=this.survey.lastTimelineNode(),e=this.survey.lastTimelineEdge(),this.survey.timeline.remove(t),this.survey.timeline.remove(e),t=this.survey.lastTimelineNode(),t.trigger("player:timeline:show")):Branchtrack.Events.trigger("player:reset player:start")},n.prototype["goto"]=function(e){var t,i,n;return t=this.survey.questions().last(2),2===t.length?(n=t[1],i=t[0]):n=t[0],n&&n.parent===e?!1:i&&i.parent===e?this.reverse():(Branchtrack.Events.trigger("player:reset"),Branchtrack.Events.trigger("player:start",e))},n.prototype.hotkey=function(e){switch(e.which){case"B".charCodeAt(0):if(!this.survey.persistable)return this.reverse()}},n.prototype.enableHotkeys=function(){return this.disableHotkeys(),$(document).on("keyup",null,"B",this.hotkey)},n.prototype.disableHotkeys=function(){return $(document).off("keyup",this.hotkey)},n.prototype.hoverLogo=function(){return this.$logo.velocity("stop").velocity({"margin-left":-this.$logo.width()})},n.prototype.blurLogo=function(){return this.$logo.velocity("stop").velocity({"margin-left":-24})},n.prototype.videoControlsBehavior=function(e){var t;return t=e?{bottom:35}:{bottom:15},this.$edges||(this.$edges=this.$("div.player-edges")),this.$feedbacks||(this.$feedbacks=this.$("div.player-feedbacks")),this.$edges.velocity("stop").velocity(t),this.$feedbacks.velocity("stop").velocity(t)},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Views.Player.TimelineEdgeView=function(i){function n(){return this.hideVoice=e(this.hideVoice,this),this.afterMedia=e(this.afterMedia,this),this.media=e(this.media,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.template=JST["player/templates/edges/timeline"],n.prototype.tagName="li",n.prototype.className="edge",n.prototype.events={"click a.control-voice":"repeatVoice"},n.prototype.initialize=function(e){return this.$container=e.container,this},n.prototype.render=function(){var e;return e=_.clone(this.model.parent.attributes),e.voice_url=this.model.getVoiceURL(),this.$el.html(this.template(e)),this.$text=this.$(".content"),this.$bubble=this.$("cite").hide(),this.renderContent(),this.renderVoice(),this.$el.appendTo(this.$container),this.top=Branchtrack.Views.get(this.model.parent,"player/show").offset().top-this.offset().top,this.$el.css({opacity:0}),this.$bubble.css({top:this.top,left:28}),this.listenTo(this.model,"player:timeline:show",this.show),this.listenTo(this.model,"player:timeline:hide",this.hide),this.listenTo(this.model.parent,"change:content",this.renderContent),this.listenTo(this.model.parent,"change:voice_id",this.renderVoice),this.listenTo(this.model.parent,"player:voice:playing",this.voicePlaying),this.listenTo(this.model.parent,"player:voice:paused player:voice:ended",this.voicePaused),this.listenTo(this.model.parent,"player:voice:paused player:voice:ended",this.afterMedia),this},n.prototype.renderContent=function(){var e;return e=window.$("<div>"+this.model.parent.getContent()+"<div>").text(),this.$text.html(e.replace(/\n{2,}/g,"<br><br>").replace(/\n/g,"<br>").autoLink({target:"_blank",rel:"nofollow"}))},n.prototype.renderVoice=function(){return this.$voice||(this.$voice=$(JST["player/templates/voices/timeline"]())),this.model.getVoiceURL()?this.$voice.appendTo(this.$bubble):this.$voice.detach()},n.prototype.show=function(){return Branchtrack.dispatchEvent("player:choice",{project:bt.project.eventJSON(),choice:this.model.eventJSON()}),Branchtrack.Events.trigger("player:timeline:edge"),this.model.parent.fromNode&&this.model.parent.fromNode.trigger("player:edges:hide"),Branchtrack.Events.trigger("player:timeline:top",this.position().top),this.$bubble.is(":visible")?void 0:(this.$el.velocity({opacity:1}),this.$bubble.velocity({top:0,left:0},{display:"inline-block",complete:this.media}))
},n.prototype.media=function(){return this.model.getVoiceURL()?Branchtrack.Events.trigger("player:voice:play",{model:this.model.parent}):(this.model.parent.toNode&&this.model.parent.toNode.getVoiceURL()||Branchtrack.Events.trigger("player:voice:hide"),this.afterMedia())},n.prototype.voicePlaying=function(e){return this.$("a.control-voice").removeClass("fa-play").addClass("fa-pause playing"),this.showVoice(),this.$progress=this.$("div.progress"),this.$progress.velocity("stop").velocity({width:["100%",e.current/e.duration*100+"%"]},{duration:1e3*(e.duration-e.current),easing:"linear"})},n.prototype.voicePaused=function(){return null!=this.$progress&&this.$progress.velocity("stop").velocity({width:"100%"},{complete:this.hideVoice}),this.$("a.control-voice").removeClass("fa-pause playing").addClass("fa-play")},n.prototype.afterMedia=function(){var e;return this.stopListening(this.model.parent,"player:voice:paused player:voice:ended",this.afterMedia),e=this.model.parent.toNode,e?bt.survey.createTimelineNode(e):void 0},n.prototype.repeatVoice=function(e){return $(e.currentTarget).hasClass("playing")?Branchtrack.Events.trigger("player:voice:stop"):this.model.getVoiceURL()?Branchtrack.Events.trigger("player:voice:play",{model:this.model.parent,force:!0}):void 0},n.prototype.showVoice=function(){return this.$track||(this.$track=this.$("div.track")),this.$track.velocity({opacity:1},{display:"block"})},n.prototype.hideVoice=function(){return this.$track.velocity({opacity:0},{display:"none"})},n.prototype.hide=function(){var e;return this.$bubble.velocity({top:this.top,left:28,opacity:0},{display:"none",complete:function(){return $(this).remove()}}),e=bt.survey.lastTimelineEdge(),e?e.trigger("player:timeline:show"):Branchtrack.Events.trigger("player:timeline:top",0)},n.prototype.offset=function(){return this.$el.offset()},n.prototype.position=function(){return this.$el.position()},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Views.Player.TimelineNodeView=function(i){function n(){return this.hideVoice=e(this.hideVoice,this),this.afterMedia=e(this.afterMedia,this),this.afterFeedback=e(this.afterFeedback,this),this.media=e(this.media,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.template=JST["player/templates/nodes/timeline"],n.prototype.tagName="li",n.prototype.className="node",n.prototype.defaultBubbleOffset=60,n.prototype.bubbleOffsetMargin=20,n.prototype.events={"click a.control-voice":"repeatVoice","click a.control-video":"repeatVideo"},n.prototype.initialize=function(e){return this.afterMediaShown=!1,this.$container=e.container,this},n.prototype.render=function(){var e;return e=_.clone(this.model.parent.attributes),this.$el.html(this.template(e)),this.$text=this.$(".content"),this.$bubble=this.$("blockquote").hide(),this.renderContent(),this.renderVoice(),Branchtrack.Views.get(this.model.parent,"player/edges").render(),this.$el.appendTo(this.$container),this.listenTo(this.model,"player:timeline:show",this.show),this.listenTo(this.model,"player:timeline:hide",this.hide),this.listenTo(this.model.parent,"change:content",this.renderContent),this.listenTo(this.model.parent,"change:voice_id",this.renderVoice),this.listenTo(this.model.parent,"player:feedback:continue",this.afterFeedback),this.listenTo(this.model.parent,"player:voice:playing",this.voicePlaying),this.listenTo(this.model.parent,"player:voice:paused player:voice:ended",this.voicePaused),this.listenTo(this.model.parent,"player:voice:paused player:voice:ended",this.afterMedia),this.listenTo(this.model.parent,"player:video:progress",this.videoProgress),this.listenTo(this.model.parent,"player:video:ended",this.videoEnded),this.listenTo(this.model.parent,"player:character:changed",this.bubbleOffset),this},n.prototype.renderContent=function(){var e;return e=$("<div>"+this.model.parent.getContent()+"<div>").text(),this.$text.html(e.replace(/\n{2,}/g,"<br><br>").replace(/\n/g,"<br>").autoLink({target:"_blank",rel:"nofollow"}))},n.prototype.renderVoice=function(){return this.model.getVoiceURL()?(this.$voice||(this.$voice=$(JST["player/templates/voices/timeline"]())),this.$voice.appendTo(this.$bubble)):null!=this.$voice?this.$voice.detach():void 0},n.prototype.show=function(){var e;return Branchtrack.dispatchEvent("player:scene",{project:bt.project.eventJSON(),scene:this.model.eventJSON()}),Branchtrack.Events.trigger("player:timeline:node"),e=this.model.parent,e.get("feedback")&&(Branchtrack.Views.get(e,"player/feedback").render(),e.trigger("player:feedback:show")),e.get("feedback")&&0!==e.edges().size()||this.afterFeedback(),0===e.edges().size()?Branchtrack.dispatchEvent("player:finish",{project:bt.project.eventJSON(),results:bt.survey.eventJSON(),scene:this.model.eventJSON()}):void 0},n.prototype.media=function(){return this.model.getVideoURL()?Branchtrack.Events.trigger("player:video:play",{model:this.model.parent}):this.model.getVoiceURL()?Branchtrack.Events.trigger("player:voice:play",{model:this.model.parent}):(Branchtrack.Events.trigger("player:media:hide"),this.afterMedia())},n.prototype.voicePlaying=function(e){return this.$("a.control-voice").removeClass("fa-play").addClass("fa-pause playing"),this.showVoice(),this.$progress||(this.$progress=this.$("div.progress")),this.$progress.velocity("stop").velocity({width:["100%",e.current/e.duration*100+"%"]},{duration:1e3*(e.duration-e.current),easing:"linear"})},n.prototype.videoProgress=function(e){var t;return t=this.model.parent.get("show_edges_delay"),t>0&&e.current<t?this.afterMediaShown?(this.afterMediaShown=!1,this.model.parent.trigger("player:edges:hide")):void 0:this.afterMedia()},n.prototype.voicePaused=function(){return null!=this.$progress&&this.$progress.velocity("stop").velocity({width:"100%"},{complete:this.hideVoice}),this.$("a.control-voice").removeClass("fa-pause playing").addClass("fa-play")},n.prototype.videoEnded=function(){var e;return e=this.model.parent.getDefaultEdge(),e?(this.afterMediaShown=!0,this.model.parent.trigger("player:feedback:hide"),this.model.parent.trigger("player:edges:hide"),bt.survey.createTimelineEdge(e)):this.afterMedia()},n.prototype.afterFeedback=function(){return this.$bubble.is(":visible")?this.afterMedia():this.model.getVideoURL()?this.media():(this.bubbleOffset(),this.$bubble.velocity({scale:[1,0]},{display:"inline-block",complete:this.media}))},n.prototype.afterMedia=function(){return this.afterMediaShown?!1:(this.afterMediaShown=!0,this.model.parent.trigger("player:edges:show"))},n.prototype.repeatVoice=function(e){return $(e.currentTarget).hasClass("playing")?Branchtrack.Events.trigger("player:voice:stop"):this.model.getVoiceURL()?Branchtrack.Events.trigger("player:voice:play",{model:this.model.parent,force:!0}):void 0},n.prototype.showVoice=function(){return this.$track||(this.$track=this.$("div.track")),this.$track.velocity({opacity:1},{display:"block"})},n.prototype.hideVoice=function(){return this.$track.velocity({opacity:0},{display:"none"})},n.prototype.repeatVideo=function(){return this.model.getVideoURL()?Branchtrack.Events.trigger("player:video:play",{model:this.model.parent,force:!0}):void 0},n.prototype.hide=function(){return this.$bubble.velocity({scale:0},{display:"none",complete:function(){return $(this).remove()}}),this.model.parent.trigger("player:feedback:hide player:edges:hide")},n.prototype.bubbleOffset=function(){return this.$bubble.velocity(bt.player.emotion&&bt.player.emotion.face&&bt.player.emotion.face.normal_x?{marginRight:-bt.player.emotion.face.normal_x+this.bubbleOffsetMargin}:{marginRight:this.defaultBubbleOffset})},n}(Backbone.View)}.call(this),function(){var e=function(e,i){function n(){this.constructor=e}for(var o in i)t.call(i,o)&&(e[o]=i[o]);return n.prototype=i.prototype,e.prototype=new n,e.__super__=i.prototype,e},t={}.hasOwnProperty;Branchtrack.Views.Player.TimelineView=function(t){function i(){return i.__super__.constructor.apply(this,arguments)}return e(i,t),i.prototype.views={},i.prototype.top=15,i.prototype.tagName="ul",i.prototype.className="player-timeline",i.prototype.initialize=function(e){return this.project=bt.project,this.container=e.container,this},i.prototype.render=function(){return this.$el.appendTo(this.container),this.listenTo(this.collection,"add",this.addOne),this.listenTo(this.collection,"reset",this.reset),this.listenTo(this.collection,"remove",this.removeOne),this.listenTo(Branchtrack.Events,"player:timeline:top",this.moveUp),this},i.prototype.addOne=function(e){var t;t=e instanceof Branchtrack.Models.TimelineNode?new Branchtrack.Views.Player.TimelineNodeView({model:e,container:this.$el}).render():new Branchtrack.Views.Player.TimelineEdgeView({model:e,container:this.$el}).render(),e.trigger("player:timeline:show"),this.views[e.cid]=t},i.prototype.reset=function(){return _(this.views).each(function(e){return e.remove()}),this.views={},this.$el.css({top:this.top})},i.prototype.moveUp=function(e){return this.$el.velocity({top:-e+this.top})},i.prototype.removeOne=function(e){return e.trigger("player:timeline:hide"),delete this.views[e.cid]},i}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Views.Player.VideoPlayerView=function(i){function n(){return this.controlshidden=e(this.controlshidden,this),this.controlsshown=e(this.controlsshown,this),this.paused=e(this.paused,this),this.ended=e(this.ended,this),this.timeupdate=e(this.timeupdate,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.template=JST["player/templates/video"],n.prototype.className="player-video",n.prototype.initialized=!1,n.prototype.queue=null,n.prototype.initialize=function(e){return this.container=e.container,this.autoplay=e.autoplay||!1,this},n.prototype.render=function(){return this.listenTo(Branchtrack.Events,"player:video:play",this.play),this.listenTo(Branchtrack.Events,"player:video:stop",this.stop),this.listenTo(Branchtrack.Events,"player:video:hide player:media:hide",this.hide),this.listenTo(Branchtrack.Events,"player:reset",this.reset),this.listenTo(Branchtrack.Events,"player:media:autoplay",this.setAutoplay),this},n.prototype.renderMediaElement=function(){return null==this.mediaElement?(this.$el.html(this.template()).appendTo(this.container),this.$video=this.$("video"),this.$media=this.$("div.media-control"),this.mediaElement=new MediaElementPlayer(this.$video[0],{type:"video/mp4",autoRewind:!1,features:["playpause","progress","current","volume","fullscreen"],enablePluginDebug:!1,videoHeight:"100%",videoWidth:"100%",enableKeyboard:!1,startVolume:1,hideVideoControlsOnLoad:!0,success:function(e){return function(t){return e.initialized=!0,t.addEventListener("timeupdate",e.timeupdate),t.addEventListener("ended",e.ended),t.addEventListener("pause",e.paused),e.queue?(e.play(e.queue),e.queue=null):void 0}}(this),error:function(){}}),this.mediaElement.container.on("controlsshown",this.controlsshown),this.mediaElement.container.on("controlshidden",this.controlshidden)):void 0},n.prototype.reset=function(){return this.hide()},n.prototype.play=function(e){return this.renderMediaElement(),this.model=e.model,this.initialized?null!=this.mediaElement&&(this.playing=!1,this.mediaElement.setSrc(this.model.getVideoURL()),this.mediaElement.load(),this.show(),this.autoplay)?this.mediaElement.play():void 0:(this.model=null,this.queue=e)},n.prototype.stop=function(){return null!=this.mediaElement?this.mediaElement.pause():void 0},n.prototype.timeupdate=function(){return null!=this.model&&(!this.playing&&this.mediaElement.media.duration&&(this.model.trigger("player:voice:playing",{current:this.mediaElement.media.currentTime,duration:this.mediaElement.media.duration}),this.playing=!0),this.model.trigger("player:video:progress",{current:this.mediaElement.media.currentTime,duration:this.mediaElement.media.duration})),!0},n.prototype.ended=function(){return null!=this.model&&(this.playing=!1,this.model.trigger("player:video:ended")),!0},n.prototype.paused=function(){return null!=this.model&&(this.playing=!1,this.model.trigger("player:video:paused")),!0},n.prototype.setAutoplay=function(e){return this.autoplay=e},n.prototype.hide=function(){return this.visible?(this.stop(),this.$el.velocity("stop").velocity({opacity:0},{complete:function(){return $(this).css({top:"100%"})}}),this.visible=!1):void 0},n.prototype.show=function(){var e;return this.visible?void 0:(e=1===bt.survey.questions().size()?0:$.Velocity.defaults.duration,this.$el.velocity("stop").css({top:0}).velocity({opacity:1},{duration:e}),this.visible=!0)},n.prototype.controlsshown=function(){return Branchtrack.Events.trigger("player:video:controls",!0)},n.prototype.controlshidden=function(){return Branchtrack.Events.trigger("player:video:controls",!1)},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t=function(e,t){function n(){this.constructor=e}for(var o in t)i.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e},i={}.hasOwnProperty;Branchtrack.Views.Player.VoicePlayerView=function(i){function n(){return this.paused=e(this.paused,this),this.ended=e(this.ended,this),this.playing=e(this.playing,this),n.__super__.constructor.apply(this,arguments)}return t(n,i),n.prototype.template=JST["player/templates/voice"],n.prototype.className="player-voice",n.prototype.events={"click a.control-volume":"toggleAutoplay"},n.prototype.initialized=!1,n.prototype.queue=null,n.prototype.initialize=function(e){return this.autoplay=e.autoplay||!1,this.container=e.container,this},n.prototype.render=function(){return this.listenTo(Branchtrack.Events,"player:voice:play",this.play),this.listenTo(Branchtrack.Events,"player:voice:stop player:media:stop",this.stop),this.listenTo(Branchtrack.Events,"player:voice:hide player:media:hide",this.hide),this.listenTo(Branchtrack.Events,"player:reset",this.reset),this.listenTo(Branchtrack.Events,"player:media:autoplay",this.setAutoplay),this},n.prototype.renderMediaElement=function(){return null==this.mediaElement?(this.$el.html(this.template()).appendTo(this.container),this.renderMute(),this.$audio=this.$("audio"),this.$media=this.$("div.media-control"),this.mediaElement=new MediaElementPlayer(this.$audio[0],{type:"audio/mpeg",enablePluginDebug:!1,enableKeyboard:!1,startVolume:1,success:function(e){return function(t){return e.initialized=!0,t.addEventListener("timeupdate",e.playing),t.addEventListener("ended",e.ended),t.addEventListener("pause",e.paused),e.queue?(e.play(e.queue),e.queue=null):void 0}}(this),error:function(){}})):void 0},n.prototype.renderMute=function(){return this.$("a.control-volume").toggleClass("disabled fa-volume-off",!this.autoplay).toggleClass("fa-volume-up",this.autoplay)},n.prototype.reset=function(){return null!=this.mediaElement&&this.mediaElement.pause(),this.hide()},n.prototype.play=function(e){return this.renderMediaElement(),this.ended(),this.model=e.model,this.initialized?this.autoplay||e.force?null!=this.mediaElement?(this.playing=!1,this.mediaElement.setSrc(this.model.getVoiceURL()),this.mediaElement.load(),this.show(),this.mediaElement.play()):void 0:this.paused():(this.model=null,this.queue=e)},n.prototype.stop=function(){return null!=this.mediaElement?this.mediaElement.pause():void 0},n.prototype.playing=function(){return null!=this.model&&!this.playing&&this.mediaElement.media.duration&&(this.model.trigger("player:voice:playing",{current:this.mediaElement.media.currentTime,duration:this.mediaElement.media.duration}),this.playing=!0),!0},n.prototype.ended=function(){return null!=this.model&&(this.playing=!1,this.model.trigger("player:voice:ended"),this.model=null),!0},n.prototype.paused=function(){return null!=this.model&&(this.playing=!1,this.model.trigger("player:voice:paused"),this.model=null),!0},n.prototype.toggleAutoplay=function(){return this.autoplay=!this.autoplay,this.renderMute(),this.autoplay?void 0:this.stop()},n.prototype.setAutoplay=function(e){return this.autoplay=e,this.renderMute()},n.prototype.hide=function(){return this.stop()},n.prototype.show=function(){},n}(Backbone.View)}.call(this),function(){$.Velocity&&($.Velocity.defaults.duration=300),window.Branchtrack.dispatchEvent=function(e,t){var i;return null==t&&(t={}),null==Branchtrack.Messages?!1:(Branchtrack.Messages.trigger(e,{details:t}),window!==window.parent&&document.referrer?(i={provider:"branchtrack",type:"branchtrack:"+e,details:t},window.parent.postMessage(JSON.stringify(i),document.referrer)):void 0)}}.call(this);